<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 4 Visualization | MetaNet Tutorial</title>
<meta name="author" content="Peng Chen">
<meta name="description" content="MetaNet supports basic R plot and provides some interfaces for other software (Gephi, Cytoscape, ggplot, networkD3) to do visualization, while there are also a lot of layout methods for better...">
<meta name="generator" content="bookdown 0.32 with bs4_book()">
<meta property="og:title" content="Chapter 4 Visualization | MetaNet Tutorial">
<meta property="og:type" content="book">
<meta property="og:image" content="/images/hexSticker1.png">
<meta property="og:description" content="MetaNet supports basic R plot and provides some interfaces for other software (Gephi, Cytoscape, ggplot, networkD3) to do visualization, while there are also a lot of layout methods for better...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 4 Visualization | MetaNet Tutorial">
<meta name="twitter:description" content="MetaNet supports basic R plot and provides some interfaces for other software (Gephi, Cytoscape, ggplot, networkD3) to do visualization, while there are also a lot of layout methods for better...">
<meta name="twitter:image" content="/images/hexSticker1.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.6.1/htmlwidgets.js"></script><script src="libs/sankeyNetwork-binding-0.3.2/sankeyNetwork.js"></script><script src="libs/d3-4.13.0/d3.min.js"></script><script src="libs/sankey-0.1/sankey.js"></script><script src="libs/forceNetwork-binding-0.4/forceNetwork.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">MetaNet Tutorial</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="construction.html"><span class="header-section-number">2</span> Construction</a></li>
<li><a class="" href="manipulation.html"><span class="header-section-number">3</span> Manipulation</a></li>
<li><a class="active" href="visualization.html"><span class="header-section-number">4</span> Visualization</a></li>
<li><a class="" href="topology.html"><span class="header-section-number">5</span> Topology</a></li>
<li><a class="" href="stability.html"><span class="header-section-number">6</span> Stability</a></li>
<li><a class="" href="Multi-omics.html"><span class="header-section-number">7</span> Multi-omics</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/Asa12138/MetaNet_tutorial">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="visualization" class="section level1" number="4">
<h1>
<span class="header-section-number">4</span> Visualization<a class="anchor" aria-label="anchor" href="#visualization"><i class="fas fa-link"></i></a>
</h1>
<p>MetaNet supports basic R plot and provides some interfaces for other software (Gephi, Cytoscape, ggplot, networkD3) to do visualization,
while there are also a lot of layout methods for better display.</p>
<div id="basic-plot" class="section level2" number="4.1">
<h2>
<span class="header-section-number">4.1</span> Basic plot<a class="anchor" aria-label="anchor" href="#basic-plot"><i class="fas fa-link"></i></a>
</h2>
<div id="set-attri" class="section level3" number="4.1.1">
<h3>
<span class="header-section-number">4.1.1</span> Set attributes<a class="anchor" aria-label="anchor" href="#set-attri"><i class="fas fa-link"></i></a>
</h3>
<p>As we mentioned earlier, there are some internal attributes have been set when building network, which are related to the network visualization (Table <a href="manipulation.html#tab:4-attribute">3.1</a>).
So you can use <code><a href="https://rdrr.io/pkg/MetaNet/man/c_net_set.html">c_net_set()</a></code> to custom these attributes fitting to your research needs.
Give the network various annotate tables and determine which columns use to set,
you can give the columns name (one or more) to <code>vertex_group, vertex_class, vertex_size, edge_type, edge_class, edge_width</code>.
Colors, linetypes, shapes and legends will be assigned automatically, just use <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> to get the basic metanet figure.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"multi_test"</span>,package <span class="op">=</span> <span class="st">"MetaNet"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"c_net"</span>,package <span class="op">=</span> <span class="st">"MetaNet"</span><span class="op">)</span></span>
<span><span class="co">#build a multi-network</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/multi_net_build.html">multi_net_build</a></span><span class="op">(</span><span class="va">micro</span>,<span class="va">metab</span>,<span class="va">transc</span><span class="op">)</span><span class="op">-&gt;</span><span class="va">multi1</span></span>
<span><span class="co">#&gt; Calculating 18 samples and 150 objects of 3 groups.</span></span>
<span><span class="co">#v_group is default, three different table</span></span>
<span></span>
<span><span class="co">#set vertex_class</span></span>
<span><span class="va">multi1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/c_net_set.html">c_net_set</a></span><span class="op">(</span><span class="va">multi1</span>,<span class="va">micro_g</span>,<span class="va">metab_g</span>,<span class="va">transc_g</span>,vertex_class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Phylum"</span>,<span class="st">"kingdom"</span>,<span class="st">"type"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#set vertex_size</span></span>
<span><span class="va">multi1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/c_net_set.html">c_net_set</a></span><span class="op">(</span><span class="va">multi1</span>,</span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="st">"Abundance1"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">micro</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="st">"Abundance2"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">metab</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="st">"Abundance3"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">transc</span><span class="op">)</span><span class="op">)</span>,vertex_size <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Abundance"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">multi1</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:5-basic"></span>
<img src="04-visualization_files/figure-html/5-basic-1.png" alt="Basic plot function" width="100%"><p class="caption">
Figure 4.1: Basic plot function
</p>
</div>
</div>
<div id="plot-setting" class="section level3" number="4.1.2">
<h3>
<span class="header-section-number">4.1.2</span> Plot setting<a class="anchor" aria-label="anchor" href="#plot-setting"><i class="fas fa-link"></i></a>
</h3>
<p>If you want to custom the network plot flexibility, use the <code><a href="https://rdrr.io/pkg/MetaNet/man/c_net_plot.html">c_net_plot()</a></code> which contains igraph arguments and some other arguments.
The arguments of <code><a href="https://rdrr.io/pkg/MetaNet/man/c_net_plot.html">c_net_plot()</a></code> show in the Table 5.1, some are different to the igraph original definition.</p>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:600px; overflow-x: scroll; width:100%; ">
<div class="inline-table"><table class="table" style="font-size: 13px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-2">Table 4.1: </span>Description of <code><a href="https://rdrr.io/pkg/MetaNet/man/c_net_plot.html">c_net_plot()</a></code> arguments.
</caption>
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Arguments
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Description
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;">
coors
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal">
<li>cooridnates dataframe</li>
<li>layout function (e.g. as_star(), as_tree(), in_circle(), nicely()… see help(c_net_lay))
</li>
</ol>
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #93aec1 !important;">
vertex.color
</td>
<td style="text-align:left;background-color: #93aec1 !important;">
color of nodes, receive vector (1. length same to number of nodes; 2. length same to numbers of v_class; 3. named verctor like c(A=“red”,B=“blue”))
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #93aec1 !important;">
vertex. shape
</td>
<td style="text-align:left;background-color: #93aec1 !important;">
shape of nodes, receive vector (1. length same to number of nodes; 2. length same to numbers of v_group; 3. named verctor like c(v_group1=“circle”,B=“square”))shape list: none, circle, square, csquare, rectangle, crectangle, vrectangle, pie, raster, or sphere
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #93aec1 !important;">
vertex.size
</td>
<td style="text-align:left;background-color: #93aec1 !important;">
size of nodes, receive numerical vector (length same to number of nodes)please use mmscale to control vertex.size, don’t be too large.
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #93aec1 !important;">
vertex_size_range
</td>
<td style="text-align:left;background-color: #93aec1 !important;">
the vertex size range, e.g. c(1,10)
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #93aec1 !important;">
labels_num
</td>
<td style="text-align:left;background-color: #93aec1 !important;">
show how many labels,&gt;1 indicates number, &lt;1 indicates fraction ,default: 5, according to the vertex.size
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #93aec1 !important;">
vertex.label
</td>
<td style="text-align:left;background-color: #93aec1 !important;">
the label of nodes, NA indicates no label
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #93aec1 !important;">
vertex.label.family
</td>
<td style="text-align:left;background-color: #93aec1 !important;">
label font family
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #93aec1 !important;">
vertex.label.font
</td>
<td style="text-align:left;background-color: #93aec1 !important;">
label font, 1 plain, 2 bold, 3 italic, 4 bold italic, 5 symbol
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #93aec1 !important;">
vertex.label.cex
</td>
<td style="text-align:left;background-color: #93aec1 !important;">
label size
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #93aec1 !important;">
vertex.label.dist
</td>
<td style="text-align:left;background-color: #93aec1 !important;">
distance from label to nodes
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #93aec1 !important;">
vertex.label.degree
</td>
<td style="text-align:left;background-color: #93aec1 !important;">
0:right, pi: left, pi/2:below, -pi/2:above
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #93aec1 !important;">
vertex.frame.color
</td>
<td style="text-align:left;background-color: #93aec1 !important;">
color of nodes frame
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #93aec1 !important;">
plot_module
</td>
<td style="text-align:left;background-color: #93aec1 !important;">
use module as the v_class
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #93aec1 !important;">
mark_module
</td>
<td style="text-align:left;background-color: #93aec1 !important;">
logical, mark the modules?
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #93aec1 !important;">
mark_color
</td>
<td style="text-align:left;background-color: #93aec1 !important;">
color of mark.groups
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #f8b042 !important;">
edge.color
</td>
<td style="text-align:left;background-color: #f8b042 !important;">
color of edges, receive vector (1. length same to number of edges; 2. length same to numbers of e_type; 3. named verctor like c(A=“red”,B=“blue”))
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #f8b042 !important;">
edge.width
</td>
<td style="text-align:left;background-color: #f8b042 !important;">
width of edge, receive numerical vector (length same to number of edges)please use mmscale to control vertex.size, don’t be too large.
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #f8b042 !important;">
edge.lty
</td>
<td style="text-align:left;background-color: #f8b042 !important;">
linetype of edge, receive vector (1. length same to number of edges; 2. length same to numbers of e_class; 3. named verctor like c(A=“red”,B=“blue”))
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #f8b042 !important;">
edge.arrow.size
</td>
<td style="text-align:left;background-color: #f8b042 !important;">
arrow size for directed network
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #f8b042 !important;">
edge.arrow.width
</td>
<td style="text-align:left;background-color: #f8b042 !important;">
arrow width for directed network
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #f8b042 !important;">
arrow.mode
</td>
<td style="text-align:left;background-color: #f8b042 !important;">
arrow mode, 0 no arrow, 1 back, 2 forward, 3 both
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #f8b042 !important;">
edge.label
</td>
<td style="text-align:left;background-color: #f8b042 !important;">
the label of edges, NA indicates no label
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #f8b042 !important;">
edge.label.family
</td>
<td style="text-align:left;background-color: #f8b042 !important;">
label font family
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #f8b042 !important;">
edge.label. font
</td>
<td style="text-align:left;background-color: #f8b042 !important;">
label font, 1 plain, 2 bold, 3 italic, 4 bold italic, 5 symbol
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #f8b042 !important;">
edge.label.cex
</td>
<td style="text-align:left;background-color: #f8b042 !important;">
label size
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #f8b042 !important;">
edge.label.x
</td>
<td style="text-align:left;background-color: #f8b042 !important;">
label x-axis
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #f8b042 !important;">
edge.label.y
</td>
<td style="text-align:left;background-color: #f8b042 !important;">
label y-axis
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #f8b042 !important;">
edge.label.color
</td>
<td style="text-align:left;background-color: #f8b042 !important;">
label color
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #f8b042 !important;">
edge.curved
</td>
<td style="text-align:left;background-color: #f8b042 !important;">
The curvature of the body, on a scale of 0-1, FALSE means 0, TRUE means 0.5
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #9dbdba !important;">
legend
</td>
<td style="text-align:left;background-color: #9dbdba !important;">
show any legend? FALSE means close all legends
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #9dbdba !important;">
legend_cex
</td>
<td style="text-align:left;background-color: #9dbdba !important;">
character expansion factor relative to current par(‘cex’), default: 1
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #9dbdba !important;">
legend_position
</td>
<td style="text-align:left;background-color: #9dbdba !important;">
legend_position, default: c(left_leg_x=-1.9,left_leg_y=1,right_leg_x=1.2,right_leg_y=1)
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #9dbdba !important;">
legend_number
</td>
<td style="text-align:left;background-color: #9dbdba !important;">
add numbers in legend? (v_class number, e_type number…)
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #9dbdba !important;">
lty_legend, lty_legend_title
</td>
<td style="text-align:left;background-color: #9dbdba !important;">
show lty_legend? and the title
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #9dbdba !important;">
size_legend, size_legend_tiltle
</td>
<td style="text-align:left;background-color: #9dbdba !important;">
show size_legend? and the title
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #9dbdba !important;">
edge_legend, edge_legend_title, edge_legend_order
</td>
<td style="text-align:left;background-color: #9dbdba !important;">
show edge_legend? and the title, the order of legend receives a vector
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #9dbdba !important;">
width_legend, width_legend_title
</td>
<td style="text-align:left;background-color: #9dbdba !important;">
show width_legend? and the title
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #9dbdba !important;">
col_legend, col_legend_order
</td>
<td style="text-align:left;background-color: #9dbdba !important;">
show col_legend? and the title, the order of legend receives a vector
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #9dbdba !important;">
group_legend_title, group_legend_order
</td>
<td style="text-align:left;background-color: #9dbdba !important;">
the title of group, the order of legend receives a vector
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #f3b7ad !important;">
margin
</td>
<td style="text-align:left;background-color: #f3b7ad !important;">
margin, a vector whose length =4
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #f3b7ad !important;">
rescale
</td>
<td style="text-align:left;background-color: #f3b7ad !important;">
scale the coors to [-1,1], default T
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #f3b7ad !important;">
asp
</td>
<td style="text-align:left;background-color: #f3b7ad !important;">
y/x ratio
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #f3b7ad !important;">
frame
</td>
<td style="text-align:left;background-color: #f3b7ad !important;">
if T, add frame
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #f3b7ad !important;">
main
</td>
<td style="text-align:left;background-color: #f3b7ad !important;">
the main title of graph
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #f3b7ad !important;">
sub
</td>
<td style="text-align:left;background-color: #f3b7ad !important;">
subtitle
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #f3b7ad !important;">
xlab
</td>
<td style="text-align:left;background-color: #f3b7ad !important;">
x-axis label
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;background-color: #f3b7ad !important;">
ylab
</td>
<td style="text-align:left;background-color: #f3b7ad !important;">
y-axis label
</td>
</tr>
</tbody>
</table></div>
</div>

</div>
</div>
<div id="layout" class="section level2" number="4.2">
<h2>
<span class="header-section-number">4.2</span> Layout<a class="anchor" aria-label="anchor" href="#layout"><i class="fas fa-link"></i></a>
</h2>
<p>Layout is an important part of network visualization, a good layout will present information clearly.
So, in <code>MetaNet</code>, we always use a dataframe to store the coordinates of a layout.
<code>coors</code> is a three-columns dataframe contains <code>name, X, Y</code>.</p>
<div id="basic-layout" class="section level3" number="4.2.1">
<h3>
<span class="header-section-number">4.2.1</span> Basic layout<a class="anchor" aria-label="anchor" href="#basic-layout"><i class="fas fa-link"></i></a>
</h3>
<p>Use <code><a href="https://rdrr.io/pkg/MetaNet/man/c_net_lay.html">c_net_lay()</a></code> to get coordinates with specific layout methods.
The method can be one of <code>as_line(), as_arc(), as_polygon(), as_polyarc()</code>,
or other graph layouts in <strong>igraph</strong> like <code>as_star(),  as_tree(),  in_circle(),  nicely(),  on_grid(),  on_sphere(),  randomly(),  with_dh(),  with_fr(),  with_gem(),  with_graphopt(),  with_kk(),  with_lgl(),  with_mds()</code>.</p>
<div class="figure">
<span style="display:block;" id="fig:layout-methods"></span>
<img src="04-visualization_files/figure-html/layout-methods-1.png" alt="Layout methods for c_net_lay()" width="100%"><p class="caption">
Figure 4.2: Layout methods for c_net_lay()
</p>
</div>
<p>And for each method, you can add some arguments in it:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#get a metanet</span></span>
<span><span class="va">go</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/erdos.renyi.game.html">erdos.renyi.game</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">0.25</span><span class="op">)</span></span>
<span><span class="va">go</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/c_net_update.html">c_net_update</a></span><span class="op">(</span><span class="va">go</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">go</span>,coors<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/layout_with_fr.html">with_fr</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">go</span>,coors<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/layout_with_fr.html">with_fr</a></span><span class="op">(</span>niter <span class="op">=</span> <span class="fl">99</span>,grid <span class="op">=</span> <span class="st">"nogrid"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The <code><a href="https://rdrr.io/pkg/MetaNet/man/as_polygon.html">as_polygon()</a></code> is interesting:</p>
<div class="figure">
<span style="display:block;" id="fig:5-multiangle"></span>
<img src="images/4-1.multiangle.gif" alt="Layout of as_polygon() in c_net_lay" width="100%"><p class="caption">
Figure 4.3: Layout of as_polygon() in c_net_lay
</p>
</div>
</div>
<div id="group-layout" class="section level3" number="4.2.2">
<h3>
<span class="header-section-number">4.2.2</span> Group layout<a class="anchor" aria-label="anchor" href="#group-layout"><i class="fas fa-link"></i></a>
</h3>
<p>Beside the <code><a href="https://rdrr.io/pkg/MetaNet/man/c_net_lay.html">c_net_lay()</a></code>, we provide an advanced layout method for a network with group variable: <code><a href="https://rdrr.io/pkg/MetaNet/man/g_lay.html">g_lay()</a></code>.
It is easy to use <code><a href="https://rdrr.io/pkg/MetaNet/man/g_lay.html">g_lay()</a></code> to control each group position and layout of each group.</p>
<ul>
<li>First, assign a group variable.</li>
<li>Give a layout1 for group position, one of
1.a dataframe or matrix: rowname is group, two columns are X and Y
2.function: layout method for <code><a href="https://rdrr.io/pkg/MetaNet/man/c_net_lay.html">c_net_lay()</a></code> default: in_circle()</li>
<li>Adjust the zoom1 of layout1.</li>
<li>Give a layout2 (layout method for <code><a href="https://rdrr.io/pkg/MetaNet/man/c_net_lay.html">c_net_lay()</a></code>) for each group layout, or use a list contains functions match each group.</li>
<li>Adjust the zoom2 of layout2. you can use a vector to adjust each group zoom.</li>
<li>use show_big_lay = T to look the layout1 distribution.</li>
</ul>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#set circle layout</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/g_lay.html">g_lay</a></span><span class="op">(</span><span class="va">multi1</span>,group <span class="op">=</span><span class="st">"v_group"</span>,layout1 <span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/layout_in_circle.html">in_circle</a></span><span class="op">(</span><span class="op">)</span>, zoom1<span class="op">=</span><span class="fl">10</span>,layout2 <span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/layout_in_circle.html">in_circle</a></span><span class="op">(</span><span class="op">)</span>,zoom2 <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">-&gt;</span><span class="va">g_coors</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">multi1</span>,coors<span class="op">=</span><span class="va">g_coors</span><span class="op">)</span></span>
<span><span class="co">#set different layout for each group</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/g_lay.html">g_lay</a></span><span class="op">(</span><span class="va">multi1</span>,group <span class="op">=</span><span class="st">"v_group"</span>,layout1 <span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/layout_in_circle.html">in_circle</a></span><span class="op">(</span><span class="op">)</span>, zoom1<span class="op">=</span><span class="fl">10</span>,layout2 <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/layout_in_circle.html">in_circle</a></span><span class="op">(</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/layout_with_fr.html">with_fr</a></span><span class="op">(</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/as_polygon.html">as_polygon</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,zoom2 <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">-&gt;</span><span class="va">g_coors</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">multi1</span>,coors<span class="op">=</span><span class="va">g_coors</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:5-g-lay"></span>
<img src="04-visualization_files/figure-html/5-g-lay-1.png" alt="Simple usage of g_lay()" width="100%"><p class="caption">
Figure 4.4: Simple usage of g_lay()
</p>
</div>
<p>As layout1 also receive a matrix or dataframe, so we can use the group skeleton of network to adjust the layout.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/g_lay.html">g_lay</a></span><span class="op">(</span><span class="va">co_net</span>,group <span class="op">=</span><span class="st">"v_class"</span>,layout1 <span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/layout_in_circle.html">in_circle</a></span><span class="op">(</span><span class="op">)</span>, zoom1<span class="op">=</span><span class="fl">10</span>,</span>
<span>      layout2 <span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/layout_in_circle.html">in_circle</a></span><span class="op">(</span><span class="op">)</span>,zoom2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">7</span><span class="op">)</span><span class="op">)</span><span class="op">-&gt;</span><span class="va">g_coors</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">co_net</span>,coors<span class="op">=</span><span class="va">g_coors</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#firstly get the skeleton plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/get_group_skeleton.html">get_group_skeleton</a></span><span class="op">(</span><span class="va">co_net</span>,<span class="st">"v_class"</span><span class="op">)</span><span class="op">-&gt;</span><span class="va">s_net</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">s_net</span><span class="op">)</span><span class="op">$</span><span class="va">size</span><span class="op">=</span><span class="fl">10</span>;<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span><span class="op">(</span><span class="va">s_net</span><span class="op">)</span><span class="op">$</span><span class="va">width</span><span class="op">=</span><span class="fl">1</span></span>
<span><span class="co">#then use tkplot to do manual adjustment.</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/tkplot.html">tkplot</a></span><span class="op">(</span><span class="va">s_net</span><span class="op">)</span></span>
<span><span class="co">#Here: Move nodes within the tkplot window to a layout you like!</span></span>
<span><span class="va">da</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/tkplot.html">tkplot.getcoords</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#close the window</span></span>
<span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/tkplot.html">tkplot.close</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#pass the da to layout1</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/g_lay.html">g_lay</a></span><span class="op">(</span><span class="va">co_net</span>,group <span class="op">=</span><span class="st">"v_class"</span>,layout1 <span class="op">=</span><span class="va">da</span>, zoom1<span class="op">=</span><span class="fl">20</span>,</span>
<span>      layout2 <span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/layout_in_circle.html">in_circle</a></span><span class="op">(</span><span class="op">)</span>,zoom2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">-&gt;</span><span class="va">g_coors</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">co_net</span>,coors<span class="op">=</span><span class="va">g_coors</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:5-tkplot"></span>
<img src="images/4-3.tkplot1.png" alt="Use tkplot to adjust big layout." width="60%"><p class="caption">
Figure 4.5: Use tkplot to adjust big layout.
</p>
</div>
<div class="figure">
<span style="display:block;" id="fig:5-tkplot2"></span>
<img src="images/4-2.tkplot.png" alt="Use tkplot to adjust big layout." width="100%"><p class="caption">
Figure 4.6: Use tkplot to adjust big layout.
</p>
</div>
<p>By the way, <code>g_lay_nice(), g_lay_polyarc(), g_lay_polygon()</code> are also good group layout method.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/g_lay.html">g_lay_nice</a></span><span class="op">(</span><span class="va">co_net</span>,group <span class="op">=</span> <span class="st">"v_class"</span><span class="op">)</span><span class="op">-&gt;</span><span class="va">g_coors</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">co_net</span>,coors<span class="op">=</span><span class="va">g_coors</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/g_lay_polygon.html">g_lay_polyarc</a></span><span class="op">(</span><span class="va">co_net</span>,group <span class="op">=</span> <span class="st">"v_class"</span>,group2_order <span class="op">=</span> <span class="st">"size"</span><span class="op">)</span><span class="op">-&gt;</span><span class="va">g_coors</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">co_net</span>,coors<span class="op">=</span><span class="va">g_coors</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:5-g-lay-2"></span>
<img src="04-visualization_files/figure-html/5-g-lay-2-1.png" alt="Usage of g_lay_nice() and g_lay_polyarc()" width="100%"><p class="caption">
Figure 4.7: Usage of g_lay_nice() and g_lay_polyarc()
</p>
</div>
<p>You can plot some more complex module-plot.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#plot_gg_circle(multi1)</span></span></code></pre></div>
</div>
</div>
<div id="other-styles" class="section level2" number="4.3">
<h2>
<span class="header-section-number">4.3</span> Other styles<a class="anchor" aria-label="anchor" href="#other-styles"><i class="fas fa-link"></i></a>
</h2>
<div id="ggplot" class="section level3" number="4.3.1">
<h3>
<span class="header-section-number">4.3.1</span> ggplot<a class="anchor" aria-label="anchor" href="#ggplot"><i class="fas fa-link"></i></a>
</h3>
<p>If you are more familiar with <code>ggplot2</code>, use the function <code><a href="https://rdrr.io/pkg/MetaNet/man/to.ggig.html">to.ggig()</a></code> transfer the basic R plot to ggplot2 style, so that you can use some convient function like <code>labs()</code>, <code>theme()</code>, <code>ggsave()</code>, <code><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">cowplot::plot_grid()</a></code> to make better figure.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/to.ggig.html">to.ggig</a></span><span class="op">(</span><span class="va">multi1</span><span class="op">)</span><span class="op">-&gt;</span><span class="va">ggig</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">ggig</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:5-ggig"></span>
<img src="04-visualization_files/figure-html/5-ggig-1.png" alt="Plot a network in ggplot2 style" width="100%"><p class="caption">
Figure 4.8: Plot a network in ggplot2 style
</p>
</div>
</div>
<div id="gephi" class="section level3" number="4.3.2">
<h3>
<span class="header-section-number">4.3.2</span> Gephi<a class="anchor" aria-label="anchor" href="#gephi"><i class="fas fa-link"></i></a>
</h3>
<p>If you are dealing with some big dataset, We recommend to use Gephi to layout.
We provide a interface to Gephi by <code>graphml</code> format file, you can use the algorithm then export a graphml file.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">co_net</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/c_net_save.html">c_net_save</a></span><span class="op">(</span><span class="va">co_net</span>,filename <span class="op">=</span> <span class="st">"test"</span>,format <span class="op">=</span> <span class="st">"graphml"</span><span class="op">)</span></span>
<span><span class="co">#then input test.graphml to Gephi and do a layout</span></span>
<span></span>
<span><span class="co">#and export a graphml file from Gephi: test2.graphml, So you can re-draw it in MetaNet</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/input_gephi.html">input_gephi</a></span><span class="op">(</span><span class="st">"test2.graphml"</span><span class="op">)</span><span class="op">-&gt;</span><span class="va">gephi</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/c_net_plot.html">c_net_plot</a></span><span class="op">(</span><span class="va">co_net</span>,coors <span class="op">=</span> <span class="va">gephi</span><span class="op">$</span><span class="va">coors</span>,legend_number <span class="op">=</span> <span class="cn">T</span>,group_legend_title <span class="op">=</span> <span class="st">"Phylum"</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="cytoscape" class="section level3" number="4.3.3">
<h3>
<span class="header-section-number">4.3.3</span> Cytoscape<a class="anchor" aria-label="anchor" href="#cytoscape"><i class="fas fa-link"></i></a>
</h3>
<p>Cytoscape is also a pretty software for network visualization which contains lots of plugins. Use the “data.frame” format to transfer network.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/c_net_save.html">c_net_save</a></span><span class="op">(</span><span class="va">co_net</span>,filename <span class="op">=</span> <span class="st">"test"</span>,format <span class="op">=</span> <span class="st">"data.frame"</span><span class="op">)</span></span>
<span><span class="co">#then input test_nodes.csv and test_edge.csv to Cytoscape.</span></span></code></pre></div>
</div>
<div id="networkd3" class="section level3" number="4.3.4">
<h3>
<span class="header-section-number">4.3.4</span> NetworkD3<a class="anchor" aria-label="anchor" href="#networkd3"><i class="fas fa-link"></i></a>
</h3>
<p>NetworkD3 can produce interactive network plot based on JavaScript,
the output object is a htmlwidgets which are suitable for website.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/netD3plot.html">netD3plot</a></span><span class="op">(</span><span class="va">multi1</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:5-netd3"></span>
<div class="forceNetwork html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-1b4ff99564eb6e8884a5" style="width:100%;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-1b4ff99564eb6e8884a5">{"x":{"links":{"source":[0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,3,3,3,3,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,7,7,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,11,11,11,12,12,12,12,13,13,14,14,14,15,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,19,19,19,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,22,22,22,22,22,22,23,23,24,25,26,26,26,26,26,26,26,26,27,27,28,28,29,30,30,30,30,30,31,31,31,31,31,31,31,32,32,32,33,33,33,33,33,33,33,33,33,34,34,34,34,35,35,35,36,36,36,36,37,38,38,38,38,38,38,38,38,38,38,39,40,40,40,41,41,41,41,41,41,41,41,41,41,41,42,43,43,43,43,43,43,43,43,43,43,43,44,44,45,46,47,47,48,49,49,49,49,50,50,50,50,50,50,50,51,51,51,51,51,52,53,53,54,54,54,54,54,55,55,55,55,55,56,56,56,57,58,59,59,60,60,60,60,61,61,61,61,61,61,61,61,63,65,65,65,65,65,65,65,65,66,66,66,66,67,68,68,68,69,69,69,69,70,71,72,72,73,74,75,75,76,77,78,78,79,81,81,83,84,85,85,85,86,87,87,87,88,89,90,91,91,91,93,94,94,95,95,96,96,96,96,98,101,102,106,108,112,113,115,116,116,116,117,127],"target":[14,18,24,34,5,9,17,20,33,38,41,43,54,55,56,61,69,78,83,104,107,115,25,26,27,28,82,104,114,11,53,108,109,82,104,106,9,20,21,26,33,38,41,43,54,61,62,65,69,83,90,112,115,116,13,57,65,94,110,14,24,84,100,133,17,20,22,33,38,41,43,54,55,56,61,69,83,85,90,104,28,40,52,44,53,108,65,74,94,110,47,94,15,24,84,81,27,77,118,22,55,69,78,102,115,125,24,34,47,51,77,88,84,87,133,33,43,46,54,61,63,66,69,83,88,90,26,29,41,115,41,55,61,96,115,129,25,27,94,27,31,41,43,50,73,101,104,121,103,114,40,82,39,51,58,96,116,129,41,43,50,60,79,85,115,53,66,97,38,39,43,54,61,65,69,73,112,36,58,77,126,70,80,111,67,77,86,107,129,43,54,61,65,69,85,94,112,115,116,93,52,80,105,43,50,55,59,61,72,73,90,93,104,115,130,50,54,55,56,61,69,83,86,90,115,119,48,126,63,54,101,121,126,56,66,96,105,53,73,90,101,104,108,132,58,85,96,116,129,80,70,71,61,69,73,83,90,56,61,69,78,107,69,72,78,65,64,93,99,79,116,122,128,65,69,83,86,96,115,116,119,66,70,85,94,96,110,116,124,129,87,96,97,117,86,93,97,134,78,81,83,115,79,79,73,110,132,110,98,121,103,113,115,125,128,86,115,86,100,92,94,116,131,96,117,133,90,129,132,103,105,122,97,96,116,113,123,116,117,124,129,120,135,133,122,109,116,123,116,119,124,129,134,131],"colour":["#48A4F0","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#E85D5D","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#E85D5D","#48A4F0","#E85D5D","#48A4F0","#E85D5D","#48A4F0","#E85D5D","#48A4F0","#48A4F0","#E85D5D","#E85D5D","#48A4F0","#E85D5D","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#E85D5D","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#E85D5D","#48A4F0","#48A4F0","#48A4F0","#E85D5D","#48A4F0","#E85D5D","#48A4F0","#E85D5D","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#E85D5D","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#E85D5D","#48A4F0","#48A4F0","#E85D5D","#48A4F0","#E85D5D","#E85D5D","#48A4F0","#E85D5D","#48A4F0","#48A4F0","#48A4F0","#E85D5D","#48A4F0","#E85D5D","#48A4F0","#E85D5D","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#E85D5D","#E85D5D","#48A4F0","#E85D5D","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#E85D5D","#E85D5D","#E85D5D","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#E85D5D","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#E85D5D","#48A4F0","#48A4F0","#E85D5D","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#E85D5D","#48A4F0","#E85D5D","#48A4F0","#48A4F0","#E85D5D","#E85D5D","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#E85D5D","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#E85D5D","#E85D5D","#48A4F0","#E85D5D","#E85D5D","#48A4F0","#E85D5D","#48A4F0","#E85D5D","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#E85D5D","#E85D5D","#48A4F0","#E85D5D","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#E85D5D","#48A4F0","#E85D5D","#E85D5D","#48A4F0","#48A4F0","#E85D5D","#48A4F0","#E85D5D","#E85D5D","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#E85D5D","#E85D5D","#E85D5D","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#E85D5D","#48A4F0","#E85D5D","#E85D5D","#48A4F0","#48A4F0","#E85D5D","#48A4F0","#E85D5D","#48A4F0","#E85D5D","#48A4F0","#48A4F0","#48A4F0","#E85D5D","#48A4F0","#E85D5D","#48A4F0","#E85D5D","#48A4F0","#48A4F0","#48A4F0","#E85D5D","#48A4F0","#E85D5D","#E85D5D","#E85D5D","#E85D5D","#48A4F0","#E85D5D","#48A4F0","#E85D5D","#E85D5D","#48A4F0","#E85D5D","#48A4F0","#E85D5D","#48A4F0","#E85D5D","#48A4F0","#48A4F0","#E85D5D","#E85D5D","#E85D5D","#48A4F0","#48A4F0","#E85D5D","#E85D5D","#48A4F0","#48A4F0","#48A4F0","#E85D5D","#48A4F0","#E85D5D","#E85D5D","#48A4F0","#E85D5D","#48A4F0","#E85D5D","#E85D5D","#48A4F0","#48A4F0","#E85D5D","#E85D5D","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#E85D5D","#48A4F0","#E85D5D","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#E85D5D","#48A4F0","#48A4F0","#E85D5D","#E85D5D","#48A4F0","#48A4F0","#E85D5D","#48A4F0","#48A4F0","#E85D5D","#E85D5D","#48A4F0","#48A4F0","#48A4F0","#E85D5D","#E85D5D","#48A4F0","#E85D5D","#E85D5D","#48A4F0","#48A4F0","#E85D5D","#E85D5D","#E85D5D","#E85D5D","#48A4F0","#E85D5D","#48A4F0","#48A4F0","#E85D5D","#E85D5D","#48A4F0","#E85D5D","#E85D5D","#E85D5D","#48A4F0","#E85D5D","#48A4F0","#E85D5D","#48A4F0","#48A4F0","#E85D5D","#48A4F0","#E85D5D","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#48A4F0","#E85D5D","#E85D5D","#E85D5D","#E85D5D","#48A4F0","#48A4F0","#E85D5D","#48A4F0","#48A4F0","#E85D5D","#E85D5D","#E85D5D","#E85D5D","#E85D5D","#48A4F0","#E85D5D","#48A4F0","#E85D5D","#48A4F0","#E85D5D","#E85D5D","#E85D5D","#E85D5D","#E85D5D","#48A4F0","#48A4F0","#E85D5D","#E85D5D","#E85D5D","#48A4F0","#E85D5D","#E85D5D","#48A4F0","#48A4F0","#48A4F0","#E85D5D","#E85D5D"]},"nodes":{"name":["s__un_f__Thermomonosporaceae","s__Pelomonas_puraquae","s__Rhizobacter_bergeniae","s__Flavobacterium_terrae","s__un_g__Rhizobacter","s__un_o__Burkholderiales","s__un_g__Streptomyces","s__Lentzea_flaviverrucosa","s__un_g__Actinoplanes","s__un_g__Rhizobium","s__un_g__Noviherbaspirillum","s__un_f__Comamonadaceae","s__Bradyrhizobium_neotropicale","s__Streptomyces_ederensis","s__Actinocorallia_herbida","s__un_g__Amycolatopsis","s__Actinophytocola_burenkhanensis","s__un_p__Proteobacteria","s__Kribbella_catacumbae","s__un_o__Rhizobiales","s__un_g__Sphingomonas","s__Amycolatopsis_keratiniphila_subsp._keratiniphila","s__Kinneretia_asaccharophila","s__un_f__Burkholderiales_incertae_sedis","s__Kineosporia_rhamnosa","s__un_f__Oxalobacteraceae","s__un_g__Bacillus","s__Pseudoduganella_violaceinigra","s__Piscinibacter_aquaticus","s__un_g__Lentzea","s__Steroidobacter_denitrificans","s__Sphingopyxis_soli","s__un_g__Herpetosiphon","s__Phenylobacterium_composti","s__un_f__Micromonosporaceae","s__un_g__Ensifer","s__un_g__Agromyces","s__un_g__Nocardioides","s__un_g__Devosia","s__un_f__Bradyrhizobiaceae","s__Noviherbaspirillum_suwonense","s__un_c__Deltaproteobacteria","s__Kibdelosporangium_phytohabitans","s__Dongia_mobilis","s__un_g__Pseudomonas","s__Pseudoxanthomonas_gei","s__un_f__Xanthomonadaceae","metabolite1","metabolite2","metabolite3","metabolite4","metabolite5","metabolite6","metabolite7","metabolite8","metabolite9","metabolite10","metabolite12","metabolite13","metabolite14","metabolite15","metabolite16","metabolite17","metabolite18","metabolite19","metabolite20","metabolite21","metabolite22","metabolite23","metabolite24","metabolite25","metabolite26","metabolite27","metabolite28","metabolite29","metabolite30","metabolite31","metabolite32","metabolite34","metabolite35","metabolite36","metabolite37","metabolite38","metabolite39","metabolite41","metabolite42","metabolite43","metabolite44","metabolite45","metabolite46","metabolite47","metabolite48","metabolite49","metabolite50","gene1","gene2","gene3","gene5","gene6","gene7","gene8","gene10","gene11","gene12","gene14","gene15","gene18","gene19","gene20","gene21","gene22","gene23","gene24","gene25","gene27","gene28","gene29","gene30","gene32","gene33","gene34","gene35","gene36","gene37","gene38","gene40","gene41","gene42","gene43","gene44","gene45","gene46","gene47","gene48","gene49","gene50"],"group":["p__Actinobacteria","p__Proteobacteria","p__Proteobacteria","p__Bacteroidetes","p__Proteobacteria","p__Proteobacteria","p__Actinobacteria","p__Actinobacteria","p__Actinobacteria","p__Proteobacteria","p__Proteobacteria","p__Proteobacteria","p__Proteobacteria","p__Actinobacteria","p__Actinobacteria","p__Actinobacteria","p__Actinobacteria","p__Proteobacteria","p__Actinobacteria","p__Proteobacteria","p__Proteobacteria","p__Actinobacteria","p__Proteobacteria","p__Proteobacteria","p__Actinobacteria","p__Proteobacteria","p__Firmicutes","p__Proteobacteria","p__Proteobacteria","p__Actinobacteria","p__Proteobacteria","p__Proteobacteria","p__Chloroflexi","p__Proteobacteria","p__Actinobacteria","p__Proteobacteria","p__Actinobacteria","p__Actinobacteria","p__Proteobacteria","p__Proteobacteria","p__Proteobacteria","p__Proteobacteria","p__Actinobacteria","p__Proteobacteria","p__Proteobacteria","p__Proteobacteria","p__Proteobacteria","B","A","A","A","A","A","A","A","A","B","A","A","A","B","A","B","A","A","B","A","A","B","B","B","B","B","B","B","A","B","A","B","B","B","B","A","A","A","B","A","B","A","A","B","B","A","A","D","C","C","C","C","D","C","D","D","D","D","D","C","D","D","C","C","C","D","C","C","D","D","D","D","D","C","C","C","D","C","D","C","D","D","D","C","D","C","D","C","C"],"nodesize":[40,38.6323000116104,25.947985603158,25.789155927087,21.981655636828,17.6314872866597,17.4491272882077,15.5299353690158,14.0739966716978,13.0018963582182,11.6606679825071,11.350361856109,10.7076899260807,9.99883896435621,8.65319865319865,7.94287704632532,7.15755253686288,7.11931576299392,7.02813576376795,6.85312899106003,6.68694608924494,6.55752931615001,6.19427996439491,6.17810286775804,6.13398351329386,6.07956964278803,5.66484771082472,5.62661093695576,5.55601996981307,5.43395642246217,5.42072061612292,5.36630674561709,5.08100158674871,5.0765896513023,5.02070513564767,4.95305545880259,4.58980610704749,4.4471535276133,4.44568288246449,4.40744610859553,4.15302449785208,3.96478191880491,3.89272030651341,3.80006966213863,3.64271063121638,3.59270869615697,3.54711869654398,3.54417740624637,3.46917450365726,3.29269708580053,3.27651998916367,3.26769611827083,3.23828321529471,3.21034095746739,3.06915902318201,3.0662177328844,3.02651031386664,2.97797902395604,2.97209644336081,2.96768450791439,2.96621386276559,2.91621192770618,2.90444676651573,2.88826966987887,2.84267967026588,2.81767870273617,2.77061805797438,2.73238128410542,2.7264987035102,2.70885096172452,2.68090870389721,2.66767289755796,2.65590773636751,2.64561322032586,2.63825999458183,2.59708193041526,2.58531676922482,2.5573745113975,2.54266805990944,2.52354967297496,2.50590193118929,2.47795967336197,2.46913580246914,2.46619451217152,2.39119160958241,2.38089709354077,2.37942644839197,2.37795580324316,2.37648515809435,2.35736677115987,2.34560160996943,2.33383644877898,2.32795386818375,2.30589419095166,2.28677580401718,2.25883354618987,2.25883354618987,2.25295096559464,2.24853903014823,2.24559773985061,2.23971515925539,2.22353806261852,2.22206741746972,2.20441967568404,2.17500677270792,2.15882967607106,2.15000580517822,2.14265257943419,2.11912225705329,2.11618096675568,2.11323967645807,2.11323967645807,2.11029838616045,2.09853322497001,2.09412128952359,2.08823870892836,2.08823870892836,2.08529741863075,2.0720616122915,2.0720616122915,2.06912032199389,2.06617903169627,2.06470838654747,2.06176709624985,2.06176709624985,2.02794225782732,2.0250009675297,2.0235303223809,2.02205967723209,2.01911838693448,2.01176516119045,2.01176516119045,2.00441193544642,2.00441193544642,2.00294129029761,2]},"options":{"NodeID":"name","Group":"group","colourScale":"d3.scaleOrdinal([`#a6bce3`,`#b2df8a`,`#fb9a99`,`#1f78b4`,`#fdbf6f`,`#33a02c`,`#cab2d6`,`#ff7f00`,`#e31a1c`])","fontSize":7,"fontFamily":"serif","clickTextSize":17.5,"linkDistance":20,"linkWidth":"function(d) { return (d.width); }","charge":-5,"opacity":0.6,"zoom":false,"legend":true,"arrows":false,"nodesize":true,"radiusCalculation":" Math.sqrt(d.nodesize)+6","bounded":false,"opacityNoHover":0,"clickAction":null}},"evals":[],"jsHooks":[]}</script><p class="caption">
Figure 4.9: Plot a network in NetworkD3 style
</p>
</div>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="manipulation.html"><span class="header-section-number">3</span> Manipulation</a></div>
<div class="next"><a href="topology.html"><span class="header-section-number">5</span> Topology</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#visualization"><span class="header-section-number">4</span> Visualization</a></li>
<li>
<a class="nav-link" href="#basic-plot"><span class="header-section-number">4.1</span> Basic plot</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#set-attri"><span class="header-section-number">4.1.1</span> Set attributes</a></li>
<li><a class="nav-link" href="#plot-setting"><span class="header-section-number">4.1.2</span> Plot setting</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#layout"><span class="header-section-number">4.2</span> Layout</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#basic-layout"><span class="header-section-number">4.2.1</span> Basic layout</a></li>
<li><a class="nav-link" href="#group-layout"><span class="header-section-number">4.2.2</span> Group layout</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#other-styles"><span class="header-section-number">4.3</span> Other styles</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#ggplot"><span class="header-section-number">4.3.1</span> ggplot</a></li>
<li><a class="nav-link" href="#gephi"><span class="header-section-number">4.3.2</span> Gephi</a></li>
<li><a class="nav-link" href="#cytoscape"><span class="header-section-number">4.3.3</span> Cytoscape</a></li>
<li><a class="nav-link" href="#networkd3"><span class="header-section-number">4.3.4</span> NetworkD3</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/Asa12138/MetaNet_tutorial/blob/master/04-visualization.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/Asa12138/MetaNet_tutorial/edit/master/04-visualization.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>MetaNet Tutorial</strong>" was written by Peng Chen. It was last built on 2023-06-27.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
