<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Topology | MetaNet Tutorial</title>
  <meta name="description" content="This is a tutorial for the network analysis R package MetaNet." />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Topology | MetaNet Tutorial" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a tutorial for the network analysis R package MetaNet." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Topology | MetaNet Tutorial" />
  
  <meta name="twitter:description" content="This is a tutorial for the network analysis R package MetaNet." />
  

<meta name="author" content="Peng Chen" />


<meta name="date" content="2023-03-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="visualization.html"/>
<link rel="next" href="stability.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">MetaNet tutorial</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#install"><i class="fa fa-check"></i><b>1.1</b> Install</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#network"><i class="fa fa-check"></i><b>2.1</b> Network</a></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#network-in-omics"><i class="fa fa-check"></i><b>2.2</b> Network in omics</a></li>
<li class="chapter" data-level="2.3" data-path="introduction.html"><a href="introduction.html#software"><i class="fa fa-check"></i><b>2.3</b> Software</a></li>
<li class="chapter" data-level="2.4" data-path="introduction.html"><a href="introduction.html#metanet"><i class="fa fa-check"></i><b>2.4</b> MetaNet</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="construction.html"><a href="construction.html"><i class="fa fa-check"></i><b>3</b> Construction</a>
<ul>
<li class="chapter" data-level="3.1" data-path="construction.html"><a href="construction.html#normalization"><i class="fa fa-check"></i><b>3.1</b> Pre-processing</a></li>
<li class="chapter" data-level="3.2" data-path="construction.html"><a href="construction.html#pairwise-relationship"><i class="fa fa-check"></i><b>3.2</b> Pairwise relationship</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="construction.html"><a href="construction.html#correlation"><i class="fa fa-check"></i><b>3.2.1</b> Correlation</a></li>
<li class="chapter" data-level="3.2.2" data-path="construction.html"><a href="construction.html#distance"><i class="fa fa-check"></i><b>3.2.2</b> Distance</a></li>
<li class="chapter" data-level="3.2.3" data-path="construction.html"><a href="construction.html#sparcc"><i class="fa fa-check"></i><b>3.2.3</b> SparCC</a></li>
<li class="chapter" data-level="3.2.4" data-path="construction.html"><a href="construction.html#others"><i class="fa fa-check"></i><b>3.2.4</b> Others</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="construction.html"><a href="construction.html#build-network"><i class="fa fa-check"></i><b>3.3</b> Build network</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="construction.html"><a href="construction.html#normally-build"><i class="fa fa-check"></i><b>3.3.1</b> Normally build</a></li>
<li class="chapter" data-level="3.3.2" data-path="construction.html"><a href="construction.html#multi-tables"><i class="fa fa-check"></i><b>3.3.2</b> Multi-tables</a></li>
<li class="chapter" data-level="3.3.3" data-path="construction.html"><a href="construction.html#edgelist"><i class="fa fa-check"></i><b>3.3.3</b> Edgelist</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="construction.html"><a href="construction.html#rmt-optimize"><i class="fa fa-check"></i><b>3.4</b> RMT optimize</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="manipulation.html"><a href="manipulation.html"><i class="fa fa-check"></i><b>4</b> Manipulation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="manipulation.html"><a href="manipulation.html#attributes"><i class="fa fa-check"></i><b>4.1</b> Attributes</a></li>
<li class="chapter" data-level="4.2" data-path="manipulation.html"><a href="manipulation.html#annotation"><i class="fa fa-check"></i><b>4.2</b> Annotation</a></li>
<li class="chapter" data-level="4.3" data-path="manipulation.html"><a href="manipulation.html#filter-sub-net"><i class="fa fa-check"></i><b>4.3</b> Filter (Sub-net)</a></li>
<li class="chapter" data-level="4.4" data-path="manipulation.html"><a href="manipulation.html#skeleton"><i class="fa fa-check"></i><b>4.4</b> Skeleton</a></li>
<li class="chapter" data-level="4.5" data-path="manipulation.html"><a href="manipulation.html#export"><i class="fa fa-check"></i><b>4.5</b> Export</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>5</b> Visualization</a>
<ul>
<li class="chapter" data-level="5.1" data-path="visualization.html"><a href="visualization.html#basic-plot"><i class="fa fa-check"></i><b>5.1</b> Basic plot</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="visualization.html"><a href="visualization.html#set-attri"><i class="fa fa-check"></i><b>5.1.1</b> Set attributes</a></li>
<li class="chapter" data-level="5.1.2" data-path="visualization.html"><a href="visualization.html#plot-setting"><i class="fa fa-check"></i><b>5.1.2</b> Plot setting</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="visualization.html"><a href="visualization.html#layout"><i class="fa fa-check"></i><b>5.2</b> Layout</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="visualization.html"><a href="visualization.html#basic-layout"><i class="fa fa-check"></i><b>5.2.1</b> Basic layout</a></li>
<li class="chapter" data-level="5.2.2" data-path="visualization.html"><a href="visualization.html#group-layout"><i class="fa fa-check"></i><b>5.2.2</b> Group layout</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="visualization.html"><a href="visualization.html#other-styles"><i class="fa fa-check"></i><b>5.3</b> Other styles</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="visualization.html"><a href="visualization.html#ggplot"><i class="fa fa-check"></i><b>5.3.1</b> ggplot</a></li>
<li class="chapter" data-level="5.3.2" data-path="visualization.html"><a href="visualization.html#gephi"><i class="fa fa-check"></i><b>5.3.2</b> Gephi</a></li>
<li class="chapter" data-level="5.3.3" data-path="visualization.html"><a href="visualization.html#cytoscape"><i class="fa fa-check"></i><b>5.3.3</b> Cytoscape</a></li>
<li class="chapter" data-level="5.3.4" data-path="visualization.html"><a href="visualization.html#networkd3"><i class="fa fa-check"></i><b>5.3.4</b> NetworkD3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="topology.html"><a href="topology.html"><i class="fa fa-check"></i><b>6</b> Topology</a>
<ul>
<li class="chapter" data-level="6.1" data-path="topology.html"><a href="topology.html#complex-network"><i class="fa fa-check"></i><b>6.1</b> Complex network</a></li>
<li class="chapter" data-level="6.2" data-path="topology.html"><a href="topology.html#modules"><i class="fa fa-check"></i><b>6.2</b> Modules</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="topology.html"><a href="topology.html#module-detection"><i class="fa fa-check"></i><b>6.2.1</b> Module detection</a></li>
<li class="chapter" data-level="6.2.2" data-path="topology.html"><a href="topology.html#keystone"><i class="fa fa-check"></i><b>6.2.2</b> Keystone</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="topology.html"><a href="topology.html#topology-indexes"><i class="fa fa-check"></i><b>6.3</b> Topology indexes</a></li>
<li class="chapter" data-level="6.4" data-path="topology.html"><a href="topology.html#random-network"><i class="fa fa-check"></i><b>6.4</b> Random network</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="stability.html"><a href="stability.html"><i class="fa fa-check"></i><b>7</b> Stability</a>
<ul>
<li class="chapter" data-level="7.1" data-path="stability.html"><a href="stability.html#robustness-tests"><i class="fa fa-check"></i><b>7.1</b> Robustness tests</a></li>
<li class="chapter" data-level="7.2" data-path="stability.html"><a href="stability.html#community-stability"><i class="fa fa-check"></i><b>7.2</b> Community stability</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="stability.html"><a href="stability.html#robustness"><i class="fa fa-check"></i><b>7.2.1</b> Robustness</a></li>
<li class="chapter" data-level="7.2.2" data-path="stability.html"><a href="stability.html#vulnerability"><i class="fa fa-check"></i><b>7.2.2</b> Vulnerability</a></li>
<li class="chapter" data-level="7.2.3" data-path="stability.html"><a href="stability.html#cohesion"><i class="fa fa-check"></i><b>7.2.3</b> Cohesion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="multi-omics.html"><a href="multi-omics.html"><i class="fa fa-check"></i><b>8</b> multi-omics</a>
<ul>
<li class="chapter" data-level="8.1" data-path="multi-omics.html"><a href="multi-omics.html#case-study"><i class="fa fa-check"></i><b>8.1</b> Case study</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="./" target="blank">Author: Peng Chen</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MetaNet Tutorial</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="topology" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> Topology<a href="topology.html#topology" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="complex-network" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Complex network<a href="topology.html#complex-network" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The microbial co-occurrence network we study is a complex network, which generally has the following characteristics, scale-free, small-world attributes, modularity and hierarchy.</p>
<table>
<caption>
<span id="tab:unnamed-chunk-2">Table 6.1: </span>Common characteristic
</caption>
<thead>
<tr>
<th style="text-align:left;">
Terminology
</th>
<th style="text-align:left;">
Explanation
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;">
Scale-free
</td>
<td style="text-align:left;">
Scale-free It is a most notable characteristic in complex systems. It was used to desibe the finding that most nodes in a network have few neighbors while few nodes have large amount of neighbors. In most cases, the connectivity distribution asymptotically follows a power law. It can be expressed in , where <span class="math inline">\(P(k) \sim k^{-y}\)</span> ,P(k) is the number of nodes with k degrees, k is connectivity/degrees andγis a constant.
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;">
Small-world
</td>
<td style="text-align:left;">
Small-world It is a terminology in network analyses to depict the average distance between nodes in a network is short, usually logarithmically with the total number of nodes. It means the network nodes are always closely related with each other.
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;">
Modularity
</td>
<td style="text-align:left;">
The modularity of a graph with respect to some division (or vertex types) measures how good the division is, or how separated are the different vertex types from each other. It defined as <span class="math inline">\(Q=\frac{1}{2m} \sum_{i,j} (A_{ij}-\gamma\frac{k_i k_j}{2m})\delta(c_i,c_j)\)</span> ,here mm is the number of edges, <span class="math inline">\(A_{ij}\)</span> is the element of the A adjacency matrix in row i and column j, <span class="math inline">\(k_i\)</span> is the degree of i, <span class="math inline">\(k_j\)</span> is the degree of j, <span class="math inline">\(c_i\)</span> is the type (or component) of i, <span class="math inline">\(c_j\)</span> that of j, the sum goes over all i and j pairs of vertices, and <span class="math inline">\(\delta(x,y)\)</span> is 1 if x=y and 0 otherwise. The resolution parameter <span class="math inline">\(\gamma\)</span> allows weighting the random null model, which might be useful when finding partitions with a high modularity.The original definition of modularity is retrieved when setting <span class="math inline">\(\gamma\)</span> to 1. (<span class="citation">Newman (<a href="#ref-newmanModularityCommunityStructure2006" role="doc-biblioref">2006</a>)</span>)
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; font-weight: bold;border-right:1px solid;">
Hierarchy
</td>
<td style="text-align:left;">
Hierarchy It was used to depict the networks which could be arranged into a hierarchy of groups representing in a tree structure. Several studies demonstrated that metabolic networks are usually accompanied by a hierarchical modularity.
</td>
</tr>
</tbody>
</table>
<p><code>fit_power()</code> is used to prove the scale-free. <code>smallworldness()</code> can calculate the smallworld index.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="topology.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;c_net&quot;</span>,<span class="at">package =</span> <span class="st">&quot;MetaNet&quot;</span>)</span>
<span id="cb1-2"><a href="topology.html#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="topology.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">fit_power</span>(co_net)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:6-power"></span>
<img src="MetaNet-Tutorial_files/figure-html/6-power-1.png" alt="Fit power-law distribution for a network." width="672" />
<p class="caption">
Figure 6.1: Fit power-law distribution for a network.
</p>
</div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="topology.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">smallworldness</span>(co_net)</span>
<span id="cb2-2"><a href="topology.html#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="do">## 43.09368</span></span></code></pre></div>
</div>
<div id="modules" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Modules<a href="topology.html#modules" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A community is a subgraph containing nodes which are more densely linked to each other than to the rest of the graph or equivalently, a graph has a community structure if the number of links into any subgraph is higher than the number of links between those subgraphs.</p>
<p>Use <code>modu_net()</code> to generate a n-modules network and do some modules analysis test.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="topology.html#cb3-1" aria-hidden="true" tabindex="-1"></a>test_modu_net<span class="ot">=</span><span class="fu">modu_net</span>(<span class="at">n_modu =</span> <span class="dv">3</span>,<span class="at">n_node_in_modu =</span> <span class="dv">30</span>)</span>
<span id="cb3-2"><a href="topology.html#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(test_modu_net,<span class="at">mark_module=</span>T)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-4"></span>
<img src="MetaNet-Tutorial_files/figure-html/unnamed-chunk-4-1.png" alt="A 3-modules network generated by modu_net()" width="672" />
<p class="caption">
Figure 6.2: A 3-modules network generated by modu_net()
</p>
</div>
<div id="module-detection" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Module detection<a href="topology.html#module-detection" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Algorithms:</p>
<ul>
<li><p>short random walks</p></li>
<li><p>leading eigenvector of the community matrix</p></li>
<li><p>simulated annealing approach</p></li>
<li><p>greedy modularity optimization</p></li>
<li><p>…</p></li>
</ul>
<p>You can get network modules by <code>modu_dect()</code> with various methods. But we sometimes just focus on several modules instead of all, so we can use <code>filter_n_modu()</code> to get modules which have more than n nodes, or keep some other modules by ids.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="topology.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>),<span class="at">mai=</span><span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">4</span>))</span>
<span id="cb4-2"><a href="topology.html#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#module detection</span></span>
<span id="cb4-3"><a href="topology.html#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">modu_dect</span>(co_net,<span class="at">method =</span> <span class="st">&quot;cluster_fast_greedy&quot;</span>) <span class="ot">-&gt;</span> co_net_modu</span>
<span id="cb4-4"><a href="topology.html#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">get_v</span>(co_net_modu)[,<span class="fu">c</span>(<span class="st">&quot;name&quot;</span>,<span class="st">&quot;module&quot;</span>)]<span class="sc">%&gt;%</span><span class="fu">head</span>()</span></code></pre></div>
<pre><code>##                           name module
## 1 s__un_f__Thermomonosporaceae      9
## 2        s__Pelomonas_puraquae      1
## 3     s__Rhizobacter_bergeniae      4
## 4     s__Flavobacterium_terrae     11
## 5         s__un_g__Rhizobacter      6
## 6     s__un_o__Burkholderiales      1</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="topology.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(co_net_modu,<span class="at">plot_module=</span>T,<span class="at">mark_module=</span>T,<span class="at">legend_position=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.8</span>,<span class="fl">1.6</span>,<span class="fl">1.1</span>,<span class="fl">1.3</span>))</span>
<span id="cb6-2"><a href="topology.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">V</span>(co_net_modu)<span class="sc">$</span>module)</span></code></pre></div>
<pre><code>## 
##  1 10 11 12 13 14 15 16 17 18 19  2 20 21 22 23 24 25 26 27 28 29  3 30  4  5 
## 61 28 18 14 16 21 15  8  6  2  4 42  3  3  2  2  2  2  2  3  2  3 30  2 31 24 
##  6  7  8  9 
## 18 21 28 16</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="topology.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#keep some modules</span></span>
<span id="cb8-2"><a href="topology.html#cb8-2" aria-hidden="true" tabindex="-1"></a>co_net_modu2<span class="ot">=</span><span class="fu">filter_n_modu</span>(co_net_modu,<span class="at">n_modu =</span> <span class="dv">30</span>,<span class="at">keep_id =</span> <span class="dv">10</span>)</span>
<span id="cb8-3"><a href="topology.html#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(co_net_modu2,<span class="at">plot_module=</span>T,<span class="at">mark_module=</span>T,<span class="at">legend_position=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.8</span>,<span class="fl">1.3</span>,<span class="fl">1.1</span>,<span class="fl">1.3</span>))</span>
<span id="cb8-4"><a href="topology.html#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="topology.html#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">#change group layout</span></span>
<span id="cb8-6"><a href="topology.html#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">g_lay_nice</span>(co_net_modu,<span class="at">group =</span> <span class="st">&quot;module&quot;</span>)<span class="ot">-&gt;</span>coors</span>
<span id="cb8-7"><a href="topology.html#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(co_net_modu2,<span class="at">coors=</span>coors,<span class="at">plot_module=</span>T,<span class="at">mark_module=</span>T)</span>
<span id="cb8-8"><a href="topology.html#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="topology.html#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">#extract some modules, delete =T will delete other modules.</span></span>
<span id="cb8-10"><a href="topology.html#cb8-10" aria-hidden="true" tabindex="-1"></a>co_net_modu3<span class="ot">=</span><span class="fu">filter_n_modu</span>(co_net_modu,<span class="at">n_modu =</span> <span class="dv">30</span>,<span class="at">keep_id =</span> <span class="dv">10</span>,<span class="at">delete =</span> T)</span>
<span id="cb8-11"><a href="topology.html#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(co_net_modu3,coors,<span class="at">plot_module=</span>T)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:6-modules"></span>
<img src="MetaNet-Tutorial_files/figure-html/6-modules-1.png" alt="Module detection results by modu_dect()" width="960" />
<p class="caption">
Figure 6.3: Module detection results by modu_dect()
</p>
</div>
<p>Look at the components of the network, some too small sub_graphs will effect the modules, if you do not care about these small components, you can just filter out them.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="topology.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">V</span>(co_net_modu)<span class="sc">$</span>components)</span></code></pre></div>
<pre><code>## 
##   1  10  11  12  13  14  15   2   3   4   5   6   7   8   9 
## 391   2   3   3   2   2   2   2   6   4   2   2   3   2   3</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="topology.html#cb11-1" aria-hidden="true" tabindex="-1"></a>co_net_modu4<span class="ot">=</span><span class="fu">c_net_filter</span>(co_net_modu,<span class="at">components=</span><span class="dv">1</span>)</span>
<span id="cb11-2"><a href="topology.html#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#re-do a module detection</span></span>
<span id="cb11-3"><a href="topology.html#cb11-3" aria-hidden="true" tabindex="-1"></a>co_net_modu4<span class="ot">=</span><span class="fu">modu_dect</span>(co_net_modu4)</span>
<span id="cb11-4"><a href="topology.html#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">g_lay_nice</span>(co_net_modu4,<span class="at">group =</span> <span class="st">&quot;module&quot;</span>)<span class="ot">-&gt;</span>coors</span>
<span id="cb11-5"><a href="topology.html#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(co_net_modu4,coors,<span class="at">plot_module=</span>T)</span></code></pre></div>
<p><img src="MetaNet-Tutorial_files/figure-html/filter-sub-1.png" width="672" /></p>
<p>Use <code>plot_module_tree()</code> can display the relationship of nodes, and <code>combine_n_modu()</code> can change the module numbers to a specific number (can not be too big or too small if there are some small small sub_graphs)</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="topology.html#cb12-1" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">=</span><span class="fu">plot_module_tree</span>(co_net_modu4)</span>
<span id="cb12-2"><a href="topology.html#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">#combine 17 modules to 5.</span></span>
<span id="cb12-3"><a href="topology.html#cb12-3" aria-hidden="true" tabindex="-1"></a>co_net_modu5<span class="ot">=</span><span class="fu">combine_n_modu</span>(co_net_modu4,<span class="dv">5</span>)</span>
<span id="cb12-4"><a href="topology.html#cb12-4" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">=</span><span class="fu">plot_module_tree</span>(co_net_modu5)</span>
<span id="cb12-5"><a href="topology.html#cb12-5" aria-hidden="true" tabindex="-1"></a>p1<span class="sc">+</span>p2</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-5"></span>
<img src="MetaNet-Tutorial_files/figure-html/unnamed-chunk-5-1.png" alt="Modules tree" width="960" />
<p class="caption">
Figure 6.4: Modules tree
</p>
</div>
<p>We could also use this network module indicates some cluster which have similar expression. But we should filter the <strong>positive</strong> edges firstly as the module detection only consider topology structure rather than the edge type. After filtering the <strong>positive</strong> edges and module detection will find some modules like WGCNA gene modules, and we can also get the “eigengene” using <code>module_eigen()</code> and have a general look at each module expression by <code>module_expression()</code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="topology.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;otutab&quot;</span>,<span class="at">package =</span> <span class="st">&quot;MetaNet&quot;</span>)</span>
<span id="cb13-2"><a href="topology.html#cb13-2" aria-hidden="true" tabindex="-1"></a>totu<span class="ot">=</span><span class="fu">t</span>(otutab)</span>
<span id="cb13-3"><a href="topology.html#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co">#filter positive edges</span></span>
<span id="cb13-4"><a href="topology.html#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">c_net_filter</span>(co_net,<span class="at">e_type=</span><span class="st">&quot;positive&quot;</span>)<span class="ot">-&gt;</span>co_net_pos</span>
<span id="cb13-5"><a href="topology.html#cb13-5" aria-hidden="true" tabindex="-1"></a>co_net_pos_modu<span class="ot">=</span><span class="fu">modu_dect</span>(co_net_pos,<span class="at">n_modu =</span> <span class="dv">10</span>,<span class="at">delete =</span> T)</span>
<span id="cb13-6"><a href="topology.html#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="topology.html#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">g_lay_nice</span>(co_net_pos_modu,<span class="at">group =</span> <span class="st">&quot;module&quot;</span>)<span class="ot">-&gt;</span>coors1</span>
<span id="cb13-8"><a href="topology.html#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(co_net_pos_modu,coors1,<span class="at">plot_module=</span>T)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:6-modu-exp-1"></span>
<img src="MetaNet-Tutorial_files/figure-html/6-modu-exp-1.png" alt="Module eigenvalue of positive cluster." width="960" />
<p class="caption">
Figure 6.5: Module eigenvalue of positive cluster.
</p>
</div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="topology.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#map the original abundance table</span></span>
<span id="cb14-2"><a href="topology.html#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">module_eigen</span>(co_net_pos_modu,totu)<span class="ot">-&gt;</span>co_net_pos_modu</span>
<span id="cb14-3"><a href="topology.html#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the expression pattern.</span></span>
<span id="cb14-4"><a href="topology.html#cb14-4" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">=</span><span class="fu">module_expression</span>(co_net_pos_modu,totu,<span class="at">cor =</span> <span class="fl">0.6</span>,<span class="at">nrow =</span> <span class="dv">4</span>)<span class="sc">+</span><span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>,<span class="at">angle =</span> <span class="dv">90</span>,<span class="at">vjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb14-5"><a href="topology.html#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="topology.html#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co">#correlate to metadata.</span></span>
<span id="cb14-7"><a href="topology.html#cb14-7" aria-hidden="true" tabindex="-1"></a>env<span class="ot">=</span>metadata[,<span class="dv">3</span><span class="sc">:</span><span class="dv">8</span>]</span>
<span id="cb14-8"><a href="topology.html#cb14-8" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">=</span><span class="fu">cor_plot</span>(<span class="fu">get_module_eigen</span>(co_net_pos_modu),env)<span class="sc">+</span><span class="fu">coord_flip</span>()</span>
<span id="cb14-9"><a href="topology.html#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="topology.html#cb14-10" aria-hidden="true" tabindex="-1"></a>p1<span class="sc">/</span>p2<span class="sc">+</span>patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:6-modu-exp-2"></span>
<img src="MetaNet-Tutorial_files/figure-html/6-modu-exp-2.png" alt="Module eigenvalue of positive cluster." width="960" />
<p class="caption">
Figure 6.6: Module eigenvalue of positive cluster.
</p>
</div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="topology.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#summary some variable according to modules.</span></span>
<span id="cb15-2"><a href="topology.html#cb15-2" aria-hidden="true" tabindex="-1"></a>p3<span class="ot">=</span><span class="fu">summ_module</span>(co_net_pos_modu,<span class="at">var =</span> <span class="st">&quot;Phylum&quot;</span>)</span>
<span id="cb15-3"><a href="topology.html#cb15-3" aria-hidden="true" tabindex="-1"></a>p4<span class="ot">=</span><span class="fu">summ_module</span>(co_net_pos_modu,<span class="at">var =</span> <span class="st">&quot;node_eigen_cor&quot;</span>)</span>
<span id="cb15-4"><a href="topology.html#cb15-4" aria-hidden="true" tabindex="-1"></a>p3<span class="sc">+</span>p4</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:6-modu-summ"></span>
<img src="MetaNet-Tutorial_files/figure-html/6-modu-summ-1.png" alt="Summary of some variables in each modules." width="960" />
<p class="caption">
Figure 6.7: Summary of some variables in each modules.
</p>
</div>
<p>Use <code>links_stat()</code> to summary the edges and find most edges are from a module to the same module (means module detection is OK).</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="topology.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">links_stat</span>(co_net_modu2,<span class="at">group =</span> <span class="st">&quot;module&quot;</span>,<span class="at">legend_number =</span> T)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-6"></span>
<img src="MetaNet-Tutorial_files/figure-html/unnamed-chunk-6-1.png" alt="Summary of edges in each modules" width="768" />
<p class="caption">
Figure 6.8: Summary of edges in each modules
</p>
</div>
</div>
<div id="keystone" class="section level3 hasAnchor" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> Keystone<a href="topology.html#keystone" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>After we determine these modules of network, the topological role of each node can be calculated according to Zi-Pi (<span class="citation">Guimerà and Amaral (<a href="#ref-guimeraFunctionalCartographyComplex2005" role="doc-biblioref">2005</a>)</span>). Within-module connectivity (Zi):</p>
<p><span class="math inline">\(Z_i= \frac{\kappa_i-\overline{\kappa_si}}{\sigma_{\kappa_{si}}}\)</span> Where <span class="math inline">\(κ_i\)</span> is the number of links of node i to other nodes in its module si, <span class="math inline">\(\overline{\kappa_{si}}\)</span> is the average of k over all the nodes in si, and <span class="math inline">\(\sigma_{\kappa_{si}}\)</span> is the standard deviation of κ in si.</p>
<p>Among-module connectivity (Pi):</p>
<p><span class="math inline">\(P_i=1-\sum_{s=1}^{N_m}{\left( {\frac{\kappa_{is}}{k_i}} \right)^2}\)</span> where <span class="math inline">\(κ_{is}\)</span> is the number of links of node i to nodes in module s, and <span class="math inline">\(k_i\)</span> is the total degree of node i.</p>
<p>And researchers often divide module roles into four categories:</p>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-7">Table 6.2: </span>The topological role of individual node
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Zi
</th>
<th style="text-align:left;">
Zi&gt;2.5
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;border-right:1px solid;">
Pi
</td>
<td style="text-align:left;">
peripherals
</td>
<td style="text-align:left;">
<span style="     color: red !important;">module hubs</span>
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;border-right:1px solid;">
Pi&gt;0.62
</td>
<td style="text-align:left;">
<span style="     color: red !important;">connectors</span>
</td>
<td style="text-align:left;">
<span style="     color: red !important;">network hubs</span>
</td>
</tr>
</tbody>
</table>
<p>And some articles define these red categories as keystone of network (<span class="citation">Liu et al. (<a href="#ref-liuEcologicalStabilityMicrobial2022" role="doc-biblioref">2022</a>)</span>).</p>
<p>Use <code>zp_analyse()</code> to get module roles and store in the vertex attributes, then we can use <code>zp_plot()</code> to visualize. We can see the module hubs are center of a module while connector are often mediate the connection of different modules.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="topology.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">zp_analyse</span>(co_net_modu4)<span class="ot">-&gt;</span>co_net_modu4</span>
<span id="cb17-2"><a href="topology.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_v</span>(co_net_modu4)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">16</span><span class="sc">:</span><span class="dv">21</span>)]<span class="sc">%&gt;%</span>head</span></code></pre></div>
<pre><code>##                           name components module origin_module Ki         Zi
## 1 s__un_f__Thermomonosporaceae          1      3             3  3  0.4531635
## 2        s__Pelomonas_puraquae          1      1             1 16  2.2142712
## 3     s__Rhizobacter_bergeniae          1      4             4  4  1.0183901
## 4     s__Flavobacterium_terrae          1     10            10  4  1.8439089
## 5         s__un_g__Rhizobacter          1      3             3  1 -1.3594905
## 6     s__un_o__Burkholderiales          1      1             1 16  2.2142712
##          Pi
## 1 0.3750000
## 2 0.2770083
## 3 0.5714286
## 4 0.0000000
## 5 0.0000000
## 6 0.2037037</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="topology.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#color map to roles</span></span>
<span id="cb19-2"><a href="topology.html#cb19-2" aria-hidden="true" tabindex="-1"></a>co_net_modu6<span class="ot">=</span><span class="fu">c_net_set</span>(co_net_modu4,<span class="at">vertex_class =</span> <span class="st">&quot;roles&quot;</span>)</span>
<span id="cb19-3"><a href="topology.html#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(co_net_modu6,coors,<span class="at">mark_module=</span>T,<span class="at">labels_num=</span><span class="dv">0</span>,<span class="at">group_legend_title=</span><span class="st">&quot;Roles&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:6-zp-1"></span>
<img src="MetaNet-Tutorial_files/figure-html/6-zp-1.png" alt="Zi-Pi analysis of a modular network." width="960" />
<p class="caption">
Figure 6.9: Zi-Pi analysis of a modular network.
</p>
</div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="topology.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb20-2"><a href="topology.html#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">zp_plot</span>(co_net_modu4,<span class="at">mode =</span> <span class="dv">1</span>)<span class="sc">+</span><span class="fu">zp_plot</span>(co_net_modu4,<span class="at">mode =</span> <span class="dv">3</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:6-zp-2"></span>
<img src="MetaNet-Tutorial_files/figure-html/6-zp-2.png" alt="Zi-Pi analysis of a modular network." width="960" />
<p class="caption">
Figure 6.10: Zi-Pi analysis of a modular network.
</p>
</div>
</div>
</div>
<div id="topology-indexes" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Topology indexes<a href="topology.html#topology-indexes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are lots of topology indexes for network analysis, we collected many indexes often used for biological research. First part is topology indexes for individual nodes.</p>
<table class="table" style="font-size: 12px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-8">Table 6.3: </span>Topology indexes for individual nodes
</caption>
<thead>
<tr>
<th style="text-align:left;">
Indexes
</th>
<th style="text-align:left;">
Formula
</th>
<th style="text-align:left;">
Note
</th>
<th style="text-align:left;">
Description
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;width: 3em; font-weight: bold;border-right:1px solid;">
Connectivity/ Degree (centrality)
</td>
<td style="text-align:left;">
<span class="math inline">\(k_i=\sum_{j\neq i}a_{ij}\)</span>
</td>
<td style="text-align:left;">
𝑎𝑖𝑗 is the connection strength between nodes i and j. when 𝑎𝑖𝑗=1, ki is the unweighted degree
</td>
<td style="text-align:left;">
It is also called node degree. It is the most commonly used concept for describing the topological property of a node in a network.
</td>
</tr>
<tr>
<td style="text-align:left;width: 3em; font-weight: bold;border-right:1px solid;">
Betweenness centrality
</td>
<td style="text-align:left;">
<span class="math inline">\(B_i=\sum_{j,k}\frac{\sigma(i,j,k)}{\sigma(j,k)}\)</span>
</td>
<td style="text-align:left;">
𝜎(𝑗,𝑖,𝑘) is the number of shortest paths between nodes j and k that pass through node i. 𝜎(𝑗,𝑘) is the total number of shortest paths between j and k.
</td>
<td style="text-align:left;">
It is used to describe the ratio of paths that pass through the ith node. High Betweenness node can serve as a broker similar to stress centrality.
</td>
</tr>
<tr>
<td style="text-align:left;width: 3em; font-weight: bold;border-right:1px solid;">
Closeness centrality
</td>
<td style="text-align:left;">
<span class="math inline">\(Ci=1/\sum_{i\neq j}d_{ij}\)</span>
</td>
<td style="text-align:left;">
The closeness centrality of a vertex is defined as the inverse of the sum of distances to all the other vertices in the graph. dij is the shortest distances from node i to j.
</td>
<td style="text-align:left;">
Closeness centrality measures how many steps is required to access every other vertex from a given vertex.
</td>
</tr>
<tr>
<td style="text-align:left;width: 3em; font-weight: bold;border-right:1px solid;">
Eigenvector centrality
</td>
<td style="text-align:left;">
<span class="math inline">\(EC_i=\frac{1}{\lambda}\sum_{j\in M(i)}EC_j\)</span>
</td>
<td style="text-align:left;">
M(𝑖) is the set of nodes that are connected to the ith node and λ is a constant eigenvalue.
</td>
<td style="text-align:left;">
It is used to describe the degree of a central node that it is connected to other central nodes.
</td>
</tr>
<tr>
<td style="text-align:left;width: 3em; font-weight: bold;border-right:1px solid;">
Clustering coefficient
</td>
<td style="text-align:left;">
<span class="math inline">\(CCo_i=\frac{2l_i}{k_i&#39;(k_i&#39;-1)}\)</span>
</td>
<td style="text-align:left;">
li is the number of links between neighbors of node i and k i ’ is the number of neighbors of node i.
</td>
<td style="text-align:left;">
It describe how well a node is connected with its neighbors. If it is fully connected to its neighbors, the clustering coefficient is 1. A value close to 0 means that there are hardly any connections with its neighbors. It was used to describe hierarchical properties of networks.
</td>
</tr>
<tr>
<td style="text-align:left;width: 3em; font-weight: bold;border-right:1px solid;">
Eccentricity
</td>
<td style="text-align:left;">
<span class="math inline">\(E_i=\max_{j\neq i}(d_{ij})\)</span>
</td>
<td style="text-align:left;">
dij is the shortest distance from node i to node j
</td>
<td style="text-align:left;">
The eccentricity of a vertex is its shortest path distance from the farthest other node in the graph.
</td>
</tr>
<tr>
<td style="text-align:left;width: 3em; font-weight: bold;border-right:1px solid;">
Page.rank
</td>
<td style="text-align:left;">
<span class="math inline">\(PR_i=\sum_{j\in B_i}\frac{PR_j}{l_j}\)</span>
</td>
<td style="text-align:left;">
i is the node whose pr value needs to be calculated, and Bi is the set of all nodes pointing to node i. PRj is the pr value of node j and lj is the number of links between neighbors of node j.
</td>
<td style="text-align:left;">
Calculates the Google PageRank for the specified vertices. PageRank, or webpage ranking, also known as webpage level, is an indicator to measure the importance of webpages.
</td>
</tr>
<tr>
<td style="text-align:left;width: 3em; font-weight: bold;border-right:1px solid;">
Kleinberg’s hub and authority centrality
</td>
<td style="text-align:left;">
<span class="math inline">\(HC=\lambda_{AA^T}\)</span> <span class="math inline">\(AC=\lambda_{A^TA}\)</span>
</td>
<td style="text-align:left;">
The hub scores of the vertices are defined as the principal eigenvector of AAT, the authority scores of the vertices are defined as the principal eigenvector of ATA. where A is the adjacency matrix of the graph.
</td>
<td style="text-align:left;">
A node is an authority if it is linked to by hubs; it is a hub if it links to authorities.
</td>
</tr>
</tbody>
</table>
<p>Second part is the overall network topological indexes.</p>
<table class="table" style="font-size: 12px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-9">Table 6.4: </span>The overall network topological indexes
</caption>
<thead>
<tr>
<th style="text-align:left;">
Indexes
</th>
<th style="text-align:left;">
Formula
</th>
<th style="text-align:left;">
Note
</th>
<th style="text-align:left;">
Description
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;width: 3em; font-weight: bold;border-right:1px solid;">
Average connectivity/ degree
</td>
<td style="text-align:left;">
<span class="math inline">\(\overline{k}=\frac{\sum_{i=1}^{n}k_i}{n}\)</span>
</td>
<td style="text-align:left;">
k i is degree of node i and n is the number of nodes.
</td>
<td style="text-align:left;">
Higher avgK means a more complex network.
</td>
</tr>
<tr>
<td style="text-align:left;width: 3em; font-weight: bold;border-right:1px solid;">
Average path length/ Average geodesic distance
</td>
<td style="text-align:left;">
<span class="math inline">\(L=\frac{\sum_{i \ne j}d_{ij}}{n(n-1)}\)</span>
</td>
<td style="text-align:left;">
dij is the shortest path between node i and j.
</td>
<td style="text-align:left;">
A smaller GD means all the nodes in the network are closer.
</td>
</tr>
<tr>
<td style="text-align:left;width: 3em; font-weight: bold;border-right:1px solid;">
global efficiency/ Geodesic efficiency
</td>
<td style="text-align:left;">
<span class="math inline">\(E_g=\frac{\sum_{i \ne j}1/d_{ij}}{n(n-1)}\)</span>
</td>
<td style="text-align:left;">
all parameters shown above.
</td>
<td style="text-align:left;">
It is the opposite of GD. A higher E means that the nodes are closer.
</td>
</tr>
<tr>
<td style="text-align:left;width: 3em; font-weight: bold;border-right:1px solid;">
Centralization of degree
</td>
<td style="text-align:left;">
<span class="math inline">\(CD=\sum_{i=1}^{n}(\max(k)-k_i)\)</span>
</td>
<td style="text-align:left;">
max(k) is the maximal value of all connectivity values and k i represents the connectivity of ith node. Finally this value is normalized by the theoretical maximum centralization score.
</td>
<td style="text-align:left;">
It is close to 1 for a network with star topology and in contrast close to 0 for a network where each node has the same connectivity.
</td>
</tr>
<tr>
<td style="text-align:left;width: 3em; font-weight: bold;border-right:1px solid;">
Centralization of betweenness
</td>
<td style="text-align:left;">
<span class="math inline">\(CB=\sum_{i=1}^{n}(\max(B)-B_i)\)</span>
</td>
<td style="text-align:left;">
max(B) is the maximal value of all betweenness values and B i represents the betweenness of ith node. Finally this value is normalized by the theoretical maximum centralization score.
</td>
<td style="text-align:left;">
It is close to 0 for a network where each node has the same betweenness, and the bigger the more difference among all betweenness values.
</td>
</tr>
<tr>
<td style="text-align:left;width: 3em; font-weight: bold;border-right:1px solid;">
Centralization of closeness
</td>
<td style="text-align:left;">
<span class="math inline">\(CC=\sum_{i=1}^{n}(\max(C)-C_i)\)</span>
</td>
<td style="text-align:left;">
max(C) is the maximal value of all closeness values and Ci represents the closeness of ith node. Finally this value is normalized by the theoretical maximum centralization score.
</td>
<td style="text-align:left;">
It is close to 0 for a network where each node has the same closeness, and the bigger the more difference among all closeness values.
</td>
</tr>
<tr>
<td style="text-align:left;width: 3em; font-weight: bold;border-right:1px solid;">
Centralization of eigenvector centrality
</td>
<td style="text-align:left;">
<span class="math inline">\(CE=\sum_{i=1}^{n}(\max(EC)-EC_i)\)</span>
</td>
<td style="text-align:left;">
max(EC) is the maximal value of all eigenvector centrality values and EC i represents the eigenvector centrality of ith node. Finally this value is normalized by the theoretical maximum centralization score.
</td>
<td style="text-align:left;">
It is close to 0 for a network where each node has the same eigenvector centrality, and the bigger the more difference among all eigenvector centrality values.
</td>
</tr>
<tr>
<td style="text-align:left;width: 3em; font-weight: bold;border-right:1px solid;">
Density
</td>
<td style="text-align:left;">
<span class="math inline">\(D=\frac{2l}{n(n-1)}\)</span>
</td>
<td style="text-align:left;">
l is the sum of total links.
</td>
<td style="text-align:left;">
The density of a graph is the ratio of the number of edges and the number of possible edges. It is closely related to the average connectivity.
</td>
</tr>
<tr>
<td style="text-align:left;width: 3em; font-weight: bold;border-right:1px solid;">
Average clustering coefficient
</td>
<td style="text-align:left;">
<span class="math inline">\(\overline{CCo}=\frac{\sum_{i=1}^{n}CCo_i}{n}\)</span>
</td>
<td style="text-align:left;">
𝐶𝐶oi is the clustering coefficient of node i.
</td>
<td style="text-align:left;">
It is used to measure the extent of module structure present in a network.
</td>
</tr>
<tr>
<td style="text-align:left;width: 3em; font-weight: bold;border-right:1px solid;">
Transitivity
</td>
<td style="text-align:left;">
<span class="math inline">\(Tr=\frac{\sum_{i=1}^{n}2l_i}{\sum_{i=1}^{n}(k&#39;_i)(k&#39;_i-1)}\)</span>
</td>
<td style="text-align:left;">
li is the number of links between neighbors of node i and k i ’ is the number of neighbors of node i.
</td>
<td style="text-align:left;">
Sometimes it is also called the entire clustering coefficient. It has been shown to be a key structural property in social networks.
</td>
</tr>
<tr>
<td style="text-align:left;width: 3em; font-weight: bold;border-right:1px solid;">
Natural connectivity
</td>
<td style="text-align:left;">
<span class="math inline">\(NC=\ln{\left(\frac{1}{N}\sum_{i=1}^{N}e^{\lambda_i}\right)}\)</span>
</td>
<td style="text-align:left;">
Where N is nodes number of the network, represents the eigenvalue of the network adjacency matrix.
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table>
<p>Edges topology indexes are less.</p>
<p>We can get all these indexes easily by using <code>net_par()</code>. you can choose different mode (n,v,e) to get network, vertexes or edges indexes especially or just use “all” to get a list contains all indexes.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="topology.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make_graph</span>(<span class="st">&quot;Walther&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">net_par</span>(<span class="at">mode =</span> <span class="st">&quot;all&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="topology.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make_graph</span>(<span class="st">&quot;Walther&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">net_par</span>(<span class="at">mode =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<pre><code>## $n_index
##      name num_nodes num_edges edge_density neg_percent ave_path_len
## 1 Walther        25        31    0.1033333          NA     3.586667
##   global_efficiency ave_degree w_ave_degree diameter clusteringC
## 1         0.3679762       2.48         2.48        8           0
##   cen_betweenness nat_connectivity
## 1       0.1436084         1.029526
## 
## $v_index
## NULL
## 
## $e_index
## NULL</code></pre>
<p>Or you can use <code>get_net_par()</code> to calculate topology indexes and store in the network itself, which is very useful if you need to do following visualization.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="topology.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#get a metanet</span></span>
<span id="cb24-2"><a href="topology.html#cb24-2" aria-hidden="true" tabindex="-1"></a>go<span class="ot">=</span><span class="fu">erdos.renyi.game</span>(<span class="dv">30</span>,<span class="fl">0.25</span>)</span>
<span id="cb24-3"><a href="topology.html#cb24-3" aria-hidden="true" tabindex="-1"></a>go<span class="ot">=</span><span class="fu">c_net_update</span>(go)</span>
<span id="cb24-4"><a href="topology.html#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb24-5"><a href="topology.html#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(go,<span class="at">legend=</span>F,<span class="at">main=</span><span class="st">&quot;Same size&quot;</span>)</span>
<span id="cb24-6"><a href="topology.html#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="topology.html#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate topology indexes and store</span></span>
<span id="cb24-8"><a href="topology.html#cb24-8" aria-hidden="true" tabindex="-1"></a>go<span class="ot">=</span><span class="fu">get_net_par</span>(go)</span>
<span id="cb24-9"><a href="topology.html#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">get_v</span>(go))</span></code></pre></div>
<pre><code>##   name label size  v_group  shape  v_class   color degree clusteringC
## 1   n1    n1   12 v_group1 circle v_class1 #a6bce3     12   0.1818182
## 2   n2    n2   12 v_group1 circle v_class1 #a6bce3     10   0.2444444
## 3   n3    n3   12 v_group1 circle v_class1 #a6bce3     10   0.2444444
## 4   n4    n4   12 v_group1 circle v_class1 #a6bce3      5   0.2000000
## 5   n5    n5   12 v_group1 circle v_class1 #a6bce3      8   0.2857143
## 6   n6    n6   12 v_group1 circle v_class1 #a6bce3      5   0.3000000
##   betweenness eccentricity  closeness hub_score
## 1   40.144078            2 0.02173913 1.0000000
## 2   22.337912            3 0.02040816 0.8552635
## 3   18.686765            3 0.02000000 0.9073534
## 4    3.986948            3 0.01724138 0.4107643
## 5   11.058859            3 0.01960784 0.7733400
## 6    2.625397            3 0.01694915 0.5020124</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="topology.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#use vertex.size to indicate degree</span></span>
<span id="cb26-2"><a href="topology.html#cb26-2" aria-hidden="true" tabindex="-1"></a>go<span class="ot">=</span><span class="fu">c_net_set</span>(go,<span class="at">vertex_size =</span><span class="st">&quot;degree&quot;</span>)</span>
<span id="cb26-3"><a href="topology.html#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(go,<span class="at">legend=</span>F,<span class="at">main=</span><span class="st">&quot;Size map to degree&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:6-degreep"></span>
<img src="MetaNet-Tutorial_files/figure-html/6-degreep-1.png" alt="Use vertex indexes for visualization." width="672" />
<p class="caption">
Figure 6.11: Use vertex indexes for visualization.
</p>
</div>
</div>
<div id="random-network" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Random network<a href="topology.html#random-network" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You can use <code>rand_net()</code> to generate a random graphs according to the Erdos-Renyi model with same node number and edge number of your network, then compare two network.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="topology.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rand_net</span>(co_net)<span class="ot">-&gt;</span>random_net</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:rand"></span>
<img src="MetaNet-Tutorial_files/figure-html/rand-1.png" alt="Comparison of complex network and random network degree distribution" width="480" />
<p class="caption">
Figure 6.12: Comparison of complex network and random network degree distribution
</p>
</div>
<p>Or use <code>rand_net_par()</code> to generate lots of random network and summary their topology indexes, then use <code>compare_rand()</code> to do the comparison.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="topology.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rand_net_par</span>(co_net,<span class="at">reps =</span> <span class="dv">30</span>)<span class="ot">-&gt;</span>randp</span>
<span id="cb28-2"><a href="topology.html#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">net_par</span>(co_net)<span class="ot">-&gt;</span>pars</span>
<span id="cb28-3"><a href="topology.html#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_rand</span>(pars,randp,<span class="at">index =</span><span class="fu">c</span>(<span class="st">&quot;ave_path_len&quot;</span>,<span class="st">&quot;clusteringC&quot;</span>))</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-12"></span>
<img src="MetaNet-Tutorial_files/figure-html/unnamed-chunk-12-1.png" alt="Comparison of complex network and random network on some indexes." width="480" />
<p class="caption">
Figure 6.13: Comparison of complex network and random network on some indexes.
</p>
</div>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-guimeraFunctionalCartographyComplex2005" class="csl-entry">
Guimerà, R., and L. Amaral. 2005. <span>“Functional Cartography of Complex Metabolic Networks.”</span> <a href="https://doi.org/10.1038/nature03288">https://doi.org/10.1038/nature03288</a>.
</div>
<div id="ref-liuEcologicalStabilityMicrobial2022" class="csl-entry">
Liu, Shengwei, Huang Yu, Yuhe Yu, Jie Huang, Zhengyuan Zhou, Jiaxiong Zeng, Pubo Chen, Fanshu Xiao, Zhili He, and Qingyun Yan. 2022. <span>“Ecological Stability of Microbial Communities in <span>Lake Donghu</span> Regulated by Keystone Taxa.”</span> <em>Ecological Indicators</em> 136 (March): 108695. <a href="https://doi.org/10.1016/j.ecolind.2022.108695">https://doi.org/10.1016/j.ecolind.2022.108695</a>.
</div>
<div id="ref-newmanModularityCommunityStructure2006" class="csl-entry">
Newman, M. E. J. 2006. <span>“Modularity and Community Structure in Networks.”</span> <em>Proceedings of the National Academy of Sciences</em> 103 (23): 8577–82. <a href="https://doi.org/10.1073/pnas.0601602103">https://doi.org/10.1073/pnas.0601602103</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="visualization.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="stability.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/05-topology.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
