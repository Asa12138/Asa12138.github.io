<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 3 Manipulation | MetaNet Tutorial</title>
<meta name="author" content="Peng Chen">
<meta name="description" content="After we build a network, we can see the class of our network is metanet, which is a derived object from igraph. So all functions used for igraph can also use on our network. data(otutab,package =...">
<meta name="generator" content="bookdown 0.32 with bs4_book()">
<meta property="og:title" content="Chapter 3 Manipulation | MetaNet Tutorial">
<meta property="og:type" content="book">
<meta property="og:description" content="After we build a network, we can see the class of our network is metanet, which is a derived object from igraph. So all functions used for igraph can also use on our network. data(otutab,package =...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 3 Manipulation | MetaNet Tutorial">
<meta name="twitter:description" content="After we build a network, we can see the class of our network is metanet, which is a derived object from igraph. So all functions used for igraph can also use on our network. data(otutab,package =...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.6.1/htmlwidgets.js"></script><script src="libs/sankeyNetwork-binding-0.3.2/sankeyNetwork.js"></script><script src="libs/d3-4.13.0/d3.min.js"></script><script src="libs/sankey-0.1/sankey.js"></script><script src="libs/forceNetwork-binding-0.4/forceNetwork.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">MetaNet Tutorial</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="construction.html"><span class="header-section-number">2</span> Construction</a></li>
<li><a class="active" href="manipulation.html"><span class="header-section-number">3</span> Manipulation</a></li>
<li><a class="" href="visualization.html"><span class="header-section-number">4</span> Visualization</a></li>
<li><a class="" href="topology.html"><span class="header-section-number">5</span> Topology</a></li>
<li><a class="" href="stability.html"><span class="header-section-number">6</span> Stability</a></li>
<li><a class="" href="Multi-omics.html"><span class="header-section-number">7</span> Multi-omics</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/Asa12138/MetaNet_tutorial">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="manipulation" class="section level1" number="3">
<h1>
<span class="header-section-number">3</span> Manipulation<a class="anchor" aria-label="anchor" href="#manipulation"><i class="fas fa-link"></i></a>
</h1>
<p>After we build a network, we can see the class of our network is metanet, which is a derived object from igraph. So all functions used for igraph can also use on our network.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">otutab</span>,package <span class="op">=</span> <span class="st">"pcutils"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">otutab</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">totu</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/c_net_cal.html">c_net_cal</a></span><span class="op">(</span><span class="va">totu</span>,method <span class="op">=</span> <span class="st">"spearman"</span>, filename <span class="op">=</span><span class="cn">F</span>, p.adjust.method <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">corr</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/c_net_build.html">c_net_build</a></span><span class="op">(</span><span class="va">corr</span>,r_thres <span class="op">=</span> <span class="fl">0.6</span>,p_thres <span class="op">=</span> <span class="fl">0.05</span>,del_single <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">co_net</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">co_net</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "metanet" "igraph"</span></span></code></pre></div>
<p>Besides, there are some other functions for us to manipulate the metanet easily.</p>
<div id="attributes" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> Attributes<a class="anchor" aria-label="anchor" href="#attributes"><i class="fas fa-link"></i></a>
</h2>
<p>We could get the attributes of whole network, each vertex and each edge by <code>get_*()</code> as dataframe:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#get network attributes</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/get_n.html">get_n</a></span><span class="op">(</span><span class="va">co_net</span><span class="op">)</span></span>
<span><span class="co">#&gt;   n_type</span></span>
<span><span class="co">#&gt; 1 single</span></span>
<span><span class="co">#get vertex attributes</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/get_v.html">get_v</a></span><span class="op">(</span><span class="va">co_net</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;                           name  v_group  v_class size</span></span>
<span><span class="co">#&gt; 1 s__un_f__Thermomonosporaceae v_group1 v_class1    4</span></span>
<span><span class="co">#&gt; 2        s__Pelomonas_puraquae v_group1 v_class1    4</span></span>
<span><span class="co">#&gt; 3     s__Rhizobacter_bergeniae v_group1 v_class1    4</span></span>
<span><span class="co">#&gt; 4     s__Flavobacterium_terrae v_group1 v_class1    4</span></span>
<span><span class="co">#&gt; 5         s__un_g__Rhizobacter v_group1 v_class1    4</span></span>
<span><span class="co">#&gt;                          label  shape   color</span></span>
<span><span class="co">#&gt; 1 s__un_f__Thermomonosporaceae circle #a6bce3</span></span>
<span><span class="co">#&gt; 2        s__Pelomonas_puraquae circle #a6bce3</span></span>
<span><span class="co">#&gt; 3     s__Rhizobacter_bergeniae circle #a6bce3</span></span>
<span><span class="co">#&gt; 4     s__Flavobacterium_terrae circle #a6bce3</span></span>
<span><span class="co">#&gt; 5         s__un_g__Rhizobacter circle #a6bce3</span></span>
<span><span class="co">#get edge attributes</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/get_e.html">get_e</a></span><span class="op">(</span><span class="va">co_net</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;   id                         from</span></span>
<span><span class="co">#&gt; 1  1 s__un_f__Thermomonosporaceae</span></span>
<span><span class="co">#&gt; 2  2 s__un_f__Thermomonosporaceae</span></span>
<span><span class="co">#&gt; 3  3 s__un_f__Thermomonosporaceae</span></span>
<span><span class="co">#&gt; 4  4 s__un_f__Thermomonosporaceae</span></span>
<span><span class="co">#&gt; 5  5 s__un_f__Thermomonosporaceae</span></span>
<span><span class="co">#&gt;                              to    weight       cor</span></span>
<span><span class="co">#&gt; 1     s__Actinocorallia_herbida 0.6759546 0.6759546</span></span>
<span><span class="co">#&gt; 2       s__Kribbella_catacumbae 0.6742386 0.6742386</span></span>
<span><span class="co">#&gt; 3       s__Kineosporia_rhamnosa 0.7378741 0.7378741</span></span>
<span><span class="co">#&gt; 4   s__un_f__Micromonosporaceae 0.6236449 0.6236449</span></span>
<span><span class="co">#&gt; 5 s__Flavobacterium_saliperosum 0.6045747 0.6045747</span></span>
<span><span class="co">#&gt;     e_type     width v_group_from v_group_to e_class</span></span>
<span><span class="co">#&gt; 1 positive 0.6759546     v_group1   v_group1   intra</span></span>
<span><span class="co">#&gt; 2 positive 0.6742386     v_group1   v_group1   intra</span></span>
<span><span class="co">#&gt; 3 positive 0.7378741     v_group1   v_group1   intra</span></span>
<span><span class="co">#&gt; 4 positive 0.6236449     v_group1   v_group1   intra</span></span>
<span><span class="co">#&gt; 5 positive 0.6045747     v_group1   v_group1   intra</span></span>
<span><span class="co">#&gt;     color lty</span></span>
<span><span class="co">#&gt; 1 #48A4F0   1</span></span>
<span><span class="co">#&gt; 2 #48A4F0   1</span></span>
<span><span class="co">#&gt; 3 #48A4F0   1</span></span>
<span><span class="co">#&gt; 4 #48A4F0   1</span></span>
<span><span class="co">#&gt; 5 #48A4F0   1</span></span></code></pre></div>
<p>And we can see, some attributes have been set when we build the network like <code>v_group</code>, these are internal attributes of metanet and are related to the following analysis and visualization.</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:4-attribute">Table 3.1: </span> Internal attributes of a metanet.</caption>
<colgroup>
<col width="20%">
<col width="79%">
</colgroup>
<thead><tr class="header">
<th>Attribute name</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>v_group</td>
<td>the big group for network, usually one omics data produces one group. Related to the vertex shape.</td>
</tr>
<tr class="even">
<td>v_class</td>
<td>some annotation of vertex, maybe classification or network modules. Related to the vertex color.</td>
</tr>
<tr class="odd">
<td>size</td>
<td>numeric variable assign to the vertex size.</td>
</tr>
<tr class="even">
<td>label</td>
<td>assign to the vertex label, replace to NA to hide some labels you don’t want to display.</td>
</tr>
<tr class="odd">
<td>e_type</td>
<td>the type of edges, often be the positive or negative according to correlation. Related to the edge color.</td>
</tr>
<tr class="even">
<td>width</td>
<td>numeric variable assign to the edge width.</td>
</tr>
<tr class="odd">
<td>e_class</td>
<td>the second type of edges, often be the intra or inter according to two vertex group. Related to the edge line type.</td>
</tr>
</tbody>
</table></div>
<p>We will talk about how to set these attributes by ourselves for some specific analysis later.</p>
</div>
<div id="annotation" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> Annotation<a class="anchor" aria-label="anchor" href="#annotation"><i class="fas fa-link"></i></a>
</h2>
<p>Sometimes we have lots of annotation tables need to add to the network, such as abundance table, taxonomy table and so on,
we can use <code><a href="https://rdrr.io/pkg/MetaNet/man/anno_vertex.html">anno_vertex()</a></code> and <code><a href="https://rdrr.io/pkg/MetaNet/man/anno_edge.html">anno_edge()</a></code> to do this.
The annotation dataframe needs have rowname or a “name” column, <code><a href="https://rdrr.io/pkg/MetaNet/man/anno_vertex.html">anno_vertex()</a></code> will automatically match the vertex name and combine the table.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/anno_vertex.html">anno_vertex</a></span><span class="op">(</span><span class="va">co_net</span>, <span class="va">taxonomy</span><span class="op">)</span><span class="op">-&gt;</span><span class="va">co_net1</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/get_v.html">get_v</a></span><span class="op">(</span><span class="va">co_net1</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;                           name  v_group  v_class size</span></span>
<span><span class="co">#&gt; 1 s__un_f__Thermomonosporaceae v_group1 v_class1    4</span></span>
<span><span class="co">#&gt; 2        s__Pelomonas_puraquae v_group1 v_class1    4</span></span>
<span><span class="co">#&gt; 3     s__Rhizobacter_bergeniae v_group1 v_class1    4</span></span>
<span><span class="co">#&gt; 4     s__Flavobacterium_terrae v_group1 v_class1    4</span></span>
<span><span class="co">#&gt; 5         s__un_g__Rhizobacter v_group1 v_class1    4</span></span>
<span><span class="co">#&gt;                          label  shape   color     Kingdom</span></span>
<span><span class="co">#&gt; 1 s__un_f__Thermomonosporaceae circle #a6bce3 k__Bacteria</span></span>
<span><span class="co">#&gt; 2        s__Pelomonas_puraquae circle #a6bce3 k__Bacteria</span></span>
<span><span class="co">#&gt; 3     s__Rhizobacter_bergeniae circle #a6bce3 k__Bacteria</span></span>
<span><span class="co">#&gt; 4     s__Flavobacterium_terrae circle #a6bce3 k__Bacteria</span></span>
<span><span class="co">#&gt; 5         s__un_g__Rhizobacter circle #a6bce3 k__Bacteria</span></span>
<span><span class="co">#&gt;              Phylum                  Class</span></span>
<span><span class="co">#&gt; 1 p__Actinobacteria      c__Actinobacteria</span></span>
<span><span class="co">#&gt; 2 p__Proteobacteria  c__Betaproteobacteria</span></span>
<span><span class="co">#&gt; 3 p__Proteobacteria c__Gammaproteobacteria</span></span>
<span><span class="co">#&gt; 4  p__Bacteroidetes      c__Flavobacteriia</span></span>
<span><span class="co">#&gt; 5 p__Proteobacteria c__Gammaproteobacteria</span></span>
<span><span class="co">#&gt;                 Order                 Family</span></span>
<span><span class="co">#&gt; 1  o__Actinomycetales f__Thermomonosporaceae</span></span>
<span><span class="co">#&gt; 2  o__Burkholderiales      f__Comamonadaceae</span></span>
<span><span class="co">#&gt; 3  o__Pseudomonadales    f__Pseudomonadaceae</span></span>
<span><span class="co">#&gt; 4 o__Flavobacteriales   f__Flavobacteriaceae</span></span>
<span><span class="co">#&gt; 5  o__Pseudomonadales    f__Pseudomonadaceae</span></span>
<span><span class="co">#&gt;                          Genus                      Species</span></span>
<span><span class="co">#&gt; 1 g__un_f__Thermomonosporaceae s__un_f__Thermomonosporaceae</span></span>
<span><span class="co">#&gt; 2                 g__Pelomonas        s__Pelomonas_puraquae</span></span>
<span><span class="co">#&gt; 3               g__Rhizobacter     s__Rhizobacter_bergeniae</span></span>
<span><span class="co">#&gt; 4            g__Flavobacterium     s__Flavobacterium_terrae</span></span>
<span><span class="co">#&gt; 5               g__Rhizobacter         s__un_g__Rhizobacter</span></span></code></pre></div>
<p><code><a href="https://rdrr.io/pkg/MetaNet/man/anno_edge.html">anno_edge()</a></code> receives the same format annotation dataframe with <code><a href="https://rdrr.io/pkg/MetaNet/man/anno_vertex.html">anno_vertex()</a></code>, it will automatically match the “from” and “to” columns so that you can summary the links.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/anno_edge.html">anno_edge</a></span><span class="op">(</span><span class="va">co_net</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">taxonomy</span>,<span class="st">"Phylum"</span><span class="op">)</span><span class="op">)</span><span class="op">-&gt;</span><span class="va">co_net1</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/get_e.html">get_e</a></span><span class="op">(</span><span class="va">co_net1</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;   id                         from</span></span>
<span><span class="co">#&gt; 1  1 s__un_f__Thermomonosporaceae</span></span>
<span><span class="co">#&gt; 2  2 s__un_f__Thermomonosporaceae</span></span>
<span><span class="co">#&gt; 3  3 s__un_f__Thermomonosporaceae</span></span>
<span><span class="co">#&gt; 4  4 s__un_f__Thermomonosporaceae</span></span>
<span><span class="co">#&gt; 5  5 s__un_f__Thermomonosporaceae</span></span>
<span><span class="co">#&gt;                              to    weight       cor</span></span>
<span><span class="co">#&gt; 1     s__Actinocorallia_herbida 0.6759546 0.6759546</span></span>
<span><span class="co">#&gt; 2       s__Kribbella_catacumbae 0.6742386 0.6742386</span></span>
<span><span class="co">#&gt; 3       s__Kineosporia_rhamnosa 0.7378741 0.7378741</span></span>
<span><span class="co">#&gt; 4   s__un_f__Micromonosporaceae 0.6236449 0.6236449</span></span>
<span><span class="co">#&gt; 5 s__Flavobacterium_saliperosum 0.6045747 0.6045747</span></span>
<span><span class="co">#&gt;     e_type     width v_group_from v_group_to e_class</span></span>
<span><span class="co">#&gt; 1 positive 0.6759546     v_group1   v_group1   intra</span></span>
<span><span class="co">#&gt; 2 positive 0.6742386     v_group1   v_group1   intra</span></span>
<span><span class="co">#&gt; 3 positive 0.7378741     v_group1   v_group1   intra</span></span>
<span><span class="co">#&gt; 4 positive 0.6236449     v_group1   v_group1   intra</span></span>
<span><span class="co">#&gt; 5 positive 0.6045747     v_group1   v_group1   intra</span></span>
<span><span class="co">#&gt;     color lty       Phylum_from         Phylum_to</span></span>
<span><span class="co">#&gt; 1 #48A4F0   1 p__Actinobacteria p__Actinobacteria</span></span>
<span><span class="co">#&gt; 2 #48A4F0   1 p__Actinobacteria p__Actinobacteria</span></span>
<span><span class="co">#&gt; 3 #48A4F0   1 p__Actinobacteria p__Actinobacteria</span></span>
<span><span class="co">#&gt; 4 #48A4F0   1 p__Actinobacteria p__Actinobacteria</span></span>
<span><span class="co">#&gt; 5 #48A4F0   1 p__Actinobacteria  p__Bacteroidetes</span></span></code></pre></div>
<p><code>MetaNet</code> provides a function <code><a href="https://rdrr.io/pkg/MetaNet/man/c_net_set.html">c_net_set()</a></code> for easily annotation if you have more than one table (it’s normal when you do a multi-omics analysis).</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Abundance_df</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="st">"Abundance"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">totu</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">co_net1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/c_net_set.html">c_net_set</a></span><span class="op">(</span><span class="va">co_net</span>,<span class="va">taxonomy</span>,<span class="va">Abundance_df</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/get_v.html">get_v</a></span><span class="op">(</span><span class="va">co_net1</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;                           name  v_group  v_class size</span></span>
<span><span class="co">#&gt; 1 s__un_f__Thermomonosporaceae v_group1 v_class1    4</span></span>
<span><span class="co">#&gt; 2        s__Pelomonas_puraquae v_group1 v_class1    4</span></span>
<span><span class="co">#&gt; 3     s__Rhizobacter_bergeniae v_group1 v_class1    4</span></span>
<span><span class="co">#&gt; 4     s__Flavobacterium_terrae v_group1 v_class1    4</span></span>
<span><span class="co">#&gt; 5         s__un_g__Rhizobacter v_group1 v_class1    4</span></span>
<span><span class="co">#&gt;                          label  shape   color     Kingdom</span></span>
<span><span class="co">#&gt; 1 s__un_f__Thermomonosporaceae circle #a6bce3 k__Bacteria</span></span>
<span><span class="co">#&gt; 2        s__Pelomonas_puraquae circle #a6bce3 k__Bacteria</span></span>
<span><span class="co">#&gt; 3     s__Rhizobacter_bergeniae circle #a6bce3 k__Bacteria</span></span>
<span><span class="co">#&gt; 4     s__Flavobacterium_terrae circle #a6bce3 k__Bacteria</span></span>
<span><span class="co">#&gt; 5         s__un_g__Rhizobacter circle #a6bce3 k__Bacteria</span></span>
<span><span class="co">#&gt;              Phylum                  Class</span></span>
<span><span class="co">#&gt; 1 p__Actinobacteria      c__Actinobacteria</span></span>
<span><span class="co">#&gt; 2 p__Proteobacteria  c__Betaproteobacteria</span></span>
<span><span class="co">#&gt; 3 p__Proteobacteria c__Gammaproteobacteria</span></span>
<span><span class="co">#&gt; 4  p__Bacteroidetes      c__Flavobacteriia</span></span>
<span><span class="co">#&gt; 5 p__Proteobacteria c__Gammaproteobacteria</span></span>
<span><span class="co">#&gt;                 Order                 Family</span></span>
<span><span class="co">#&gt; 1  o__Actinomycetales f__Thermomonosporaceae</span></span>
<span><span class="co">#&gt; 2  o__Burkholderiales      f__Comamonadaceae</span></span>
<span><span class="co">#&gt; 3  o__Pseudomonadales    f__Pseudomonadaceae</span></span>
<span><span class="co">#&gt; 4 o__Flavobacteriales   f__Flavobacteriaceae</span></span>
<span><span class="co">#&gt; 5  o__Pseudomonadales    f__Pseudomonadaceae</span></span>
<span><span class="co">#&gt;                          Genus                      Species</span></span>
<span><span class="co">#&gt; 1 g__un_f__Thermomonosporaceae s__un_f__Thermomonosporaceae</span></span>
<span><span class="co">#&gt; 2                 g__Pelomonas        s__Pelomonas_puraquae</span></span>
<span><span class="co">#&gt; 3               g__Rhizobacter     s__Rhizobacter_bergeniae</span></span>
<span><span class="co">#&gt; 4            g__Flavobacterium     s__Flavobacterium_terrae</span></span>
<span><span class="co">#&gt; 5               g__Rhizobacter         s__un_g__Rhizobacter</span></span>
<span><span class="co">#&gt;   Abundance</span></span>
<span><span class="co">#&gt; 1     26147</span></span>
<span><span class="co">#&gt; 2     25217</span></span>
<span><span class="co">#&gt; 3     16592</span></span>
<span><span class="co">#&gt; 4     16484</span></span>
<span><span class="co">#&gt; 5     13895</span></span></code></pre></div>
<p>If you have a vector and you absolutely know it matches the vertex name of network,
you can use igraph method to annotate (Don’t recommend), same as the edge annotate vector:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">co_net1</span><span class="op">=</span><span class="va">co_net</span></span>
<span></span>
<span><span class="co">#add vertex attribute</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">co_net1</span><span class="op">)</span><span class="op">$</span><span class="va">new_attri</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">co_net1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/get_v.html">get_v</a></span><span class="op">(</span><span class="va">co_net1</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;                           name  v_group  v_class size</span></span>
<span><span class="co">#&gt; 1 s__un_f__Thermomonosporaceae v_group1 v_class1    4</span></span>
<span><span class="co">#&gt; 2        s__Pelomonas_puraquae v_group1 v_class1    4</span></span>
<span><span class="co">#&gt; 3     s__Rhizobacter_bergeniae v_group1 v_class1    4</span></span>
<span><span class="co">#&gt; 4     s__Flavobacterium_terrae v_group1 v_class1    4</span></span>
<span><span class="co">#&gt; 5         s__un_g__Rhizobacter v_group1 v_class1    4</span></span>
<span><span class="co">#&gt;                          label  shape   color new_attri</span></span>
<span><span class="co">#&gt; 1 s__un_f__Thermomonosporaceae circle #a6bce3         1</span></span>
<span><span class="co">#&gt; 2        s__Pelomonas_puraquae circle #a6bce3         2</span></span>
<span><span class="co">#&gt; 3     s__Rhizobacter_bergeniae circle #a6bce3         3</span></span>
<span><span class="co">#&gt; 4     s__Flavobacterium_terrae circle #a6bce3         4</span></span>
<span><span class="co">#&gt; 5         s__un_g__Rhizobacter circle #a6bce3         5</span></span>
<span></span>
<span><span class="co">#add edge attribute</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span><span class="op">(</span><span class="va">co_net1</span><span class="op">)</span><span class="op">$</span><span class="va">new_attri</span><span class="op">=</span><span class="st">"new attribute"</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/get_e.html">get_e</a></span><span class="op">(</span><span class="va">co_net1</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;   id                         from</span></span>
<span><span class="co">#&gt; 1  1 s__un_f__Thermomonosporaceae</span></span>
<span><span class="co">#&gt; 2  2 s__un_f__Thermomonosporaceae</span></span>
<span><span class="co">#&gt; 3  3 s__un_f__Thermomonosporaceae</span></span>
<span><span class="co">#&gt; 4  4 s__un_f__Thermomonosporaceae</span></span>
<span><span class="co">#&gt; 5  5 s__un_f__Thermomonosporaceae</span></span>
<span><span class="co">#&gt;                              to    weight       cor</span></span>
<span><span class="co">#&gt; 1     s__Actinocorallia_herbida 0.6759546 0.6759546</span></span>
<span><span class="co">#&gt; 2       s__Kribbella_catacumbae 0.6742386 0.6742386</span></span>
<span><span class="co">#&gt; 3       s__Kineosporia_rhamnosa 0.7378741 0.7378741</span></span>
<span><span class="co">#&gt; 4   s__un_f__Micromonosporaceae 0.6236449 0.6236449</span></span>
<span><span class="co">#&gt; 5 s__Flavobacterium_saliperosum 0.6045747 0.6045747</span></span>
<span><span class="co">#&gt;     e_type     width v_group_from v_group_to e_class</span></span>
<span><span class="co">#&gt; 1 positive 0.6759546     v_group1   v_group1   intra</span></span>
<span><span class="co">#&gt; 2 positive 0.6742386     v_group1   v_group1   intra</span></span>
<span><span class="co">#&gt; 3 positive 0.7378741     v_group1   v_group1   intra</span></span>
<span><span class="co">#&gt; 4 positive 0.6236449     v_group1   v_group1   intra</span></span>
<span><span class="co">#&gt; 5 positive 0.6045747     v_group1   v_group1   intra</span></span>
<span><span class="co">#&gt;     color lty     new_attri</span></span>
<span><span class="co">#&gt; 1 #48A4F0   1 new attribute</span></span>
<span><span class="co">#&gt; 2 #48A4F0   1 new attribute</span></span>
<span><span class="co">#&gt; 3 #48A4F0   1 new attribute</span></span>
<span><span class="co">#&gt; 4 #48A4F0   1 new attribute</span></span>
<span><span class="co">#&gt; 5 #48A4F0   1 new attribute</span></span></code></pre></div>
</div>
<div id="filter-sub-net" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> Filter (Sub-net)<a class="anchor" aria-label="anchor" href="#filter-sub-net"><i class="fas fa-link"></i></a>
</h2>
<p>After setting your network properly, you may need to analysis part of the whole network (especially in the multi-omics analysis),
<code><a href="https://rdrr.io/pkg/MetaNet/man/c_net_filter.html">c_net_filter()</a></code> can get the sub-net conveniently (Figure <a href="manipulation.html#fig:4-filter">3.1</a>), you can put lots of filter conditions in:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"multi_net"</span>,package <span class="op">=</span> <span class="st">"MetaNet"</span><span class="op">)</span></span>
<span><span class="va">multi2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/c_net_filter.html">c_net_filter</a></span><span class="op">(</span><span class="va">multi1</span>,<span class="va">v_group</span><span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"omic1"</span>,<span class="st">"omic2"</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/c_net_filter.html">c_net_filter</a></span><span class="op">(</span><span class="va">.</span>,<span class="va">e_class</span><span class="op">==</span><span class="st">"intra"</span>,mode <span class="op">=</span> <span class="st">"e"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">multi1</span>,lty_legend<span class="op">=</span><span class="cn">T</span>,main<span class="op">=</span><span class="st">"Before filtering network"</span><span class="op">)</span><span class="co">#before filter</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">multi2</span>,lty_legend<span class="op">=</span><span class="cn">T</span>,main<span class="op">=</span><span class="st">"After filtering network"</span><span class="op">)</span> <span class="co">#after filter</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:4-filter"></span>
<img src="03-manipulation_files/figure-html/4-filter-1.png" alt="From a whole network filter a sub-net." width="100%"><p class="caption">
Figure 3.1: From a whole network filter a sub-net.
</p>
</div>
</div>
<div id="skeleton" class="section level2" number="3.4">
<h2>
<span class="header-section-number">3.4</span> Skeleton<a class="anchor" aria-label="anchor" href="#skeleton"><i class="fas fa-link"></i></a>
</h2>
<p>If you want to summary the edges source and target according to one group, <code>summ_2col</code> is a easy way to get this information. <code>direct = F</code> argument means this is a undirected relationship, so “a-b” and “b-a” will summary to one type edge.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/anno_edge.html">anno_edge</a></span><span class="op">(</span><span class="va">co_net</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">taxonomy</span>,<span class="st">"Phylum"</span><span class="op">)</span><span class="op">)</span><span class="op">-&gt;</span><span class="va">co_net1</span></span>
<span><span class="va">df</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/get_e.html">get_e</a></span><span class="op">(</span><span class="va">co_net1</span><span class="op">)</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Phylum_from"</span>,<span class="st">"Phylum_to"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/summ_2col.html">summ_2col</a></span><span class="op">(</span><span class="va">df</span>,direct <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">count</span><span class="op">)</span><span class="op">-&gt;</span><span class="va">Phylum_from_to</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">kbl</span><span class="op">(</span><span class="va">Phylum_from_to</span>,caption <span class="op">=</span> <span class="st">"Summary of edges according to Phylum"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">kable_paper</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">scroll_box</span><span class="op">(</span>width <span class="op">=</span> <span class="st">"100%"</span>, height <span class="op">=</span> <span class="st">"400px"</span><span class="op">)</span></span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:400px; overflow-x: scroll; width:100%; ">
<div class="inline-table"><table class=" lightable-paper" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
<caption>
<span id="tab:4-summ-2col">Table 3.2: </span>Summary of edges according to Phylum
</caption>
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Phylum_from
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Phylum_to
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
count
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
p__Proteobacteria
</td>
<td style="text-align:left;">
p__Proteobacteria
</td>
<td style="text-align:right;">
401
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Actinobacteria
</td>
<td style="text-align:left;">
p__Proteobacteria
</td>
<td style="text-align:right;">
353
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Firmicutes
</td>
<td style="text-align:left;">
p__Proteobacteria
</td>
<td style="text-align:right;">
143
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Actinobacteria
</td>
<td style="text-align:left;">
p__Actinobacteria
</td>
<td style="text-align:right;">
123
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Bacteroidetes
</td>
<td style="text-align:left;">
p__Proteobacteria
</td>
<td style="text-align:right;">
99
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Actinobacteria
</td>
<td style="text-align:left;">
p__Firmicutes
</td>
<td style="text-align:right;">
78
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Actinobacteria
</td>
<td style="text-align:left;">
p__Bacteroidetes
</td>
<td style="text-align:right;">
48
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Acidobacteria
</td>
<td style="text-align:left;">
p__Proteobacteria
</td>
<td style="text-align:right;">
35
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Chloroflexi
</td>
<td style="text-align:left;">
p__Proteobacteria
</td>
<td style="text-align:right;">
23
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Firmicutes
</td>
<td style="text-align:left;">
p__Firmicutes
</td>
<td style="text-align:right;">
23
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Proteobacteria
</td>
<td style="text-align:left;">
p__Verrucomicrobia
</td>
<td style="text-align:right;">
22
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Acidobacteria
</td>
<td style="text-align:left;">
p__Actinobacteria
</td>
<td style="text-align:right;">
18
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Bacteroidetes
</td>
<td style="text-align:left;">
p__Firmicutes
</td>
<td style="text-align:right;">
18
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Chlamydiae
</td>
<td style="text-align:left;">
p__Proteobacteria
</td>
<td style="text-align:right;">
14
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Planctomycetes
</td>
<td style="text-align:left;">
p__Proteobacteria
</td>
<td style="text-align:right;">
14
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Actinobacteria
</td>
<td style="text-align:left;">
p__Verrucomicrobia
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Actinobacteria
</td>
<td style="text-align:left;">
p__Chloroflexi
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Actinobacteria
</td>
<td style="text-align:left;">
p__Planctomycetes
</td>
<td style="text-align:right;">
9
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Bacteroidetes
</td>
<td style="text-align:left;">
p__Bacteroidetes
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Chloroflexi
</td>
<td style="text-align:left;">
p__Firmicutes
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Bacteroidetes
</td>
<td style="text-align:left;">
p__Chlamydiae
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Proteobacteria
</td>
<td style="text-align:left;">
p__Spirochaetes
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Acidobacteria
</td>
<td style="text-align:left;">
p__Bacteroidetes
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Acidobacteria
</td>
<td style="text-align:left;">
p__Chloroflexi
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Acidobacteria
</td>
<td style="text-align:left;">
p__Firmicutes
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Actinobacteria
</td>
<td style="text-align:left;">
p__Chlamydiae
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Bacteroidetes
</td>
<td style="text-align:left;">
p__Chloroflexi
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Bacteroidetes
</td>
<td style="text-align:left;">
p__Verrucomicrobia
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Candidatus_Saccharibacteria
</td>
<td style="text-align:left;">
p__Proteobacteria
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Firmicutes
</td>
<td style="text-align:left;">
p__Verrucomicrobia
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Nitrospirae
</td>
<td style="text-align:left;">
p__Proteobacteria
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Actinobacteria
</td>
<td style="text-align:left;">
p__Spirochaetes
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Armatimonadetes
</td>
<td style="text-align:left;">
p__Proteobacteria
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Bacteroidetes
</td>
<td style="text-align:left;">
p__Spirochaetes
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Chlamydiae
</td>
<td style="text-align:left;">
p__Firmicutes
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Ignavibacteriae
</td>
<td style="text-align:left;">
p__Proteobacteria
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Actinobacteria
</td>
<td style="text-align:left;">
p__Nitrospirae
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Chlamydiae
</td>
<td style="text-align:left;">
p__Spirochaetes
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Chloroflexi
</td>
<td style="text-align:left;">
p__Ignavibacteriae
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Chloroflexi
</td>
<td style="text-align:left;">
p__Verrucomicrobia
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Firmicutes
</td>
<td style="text-align:left;">
p__Planctomycetes
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Firmicutes
</td>
<td style="text-align:left;">
p__Spirochaetes
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Proteobacteria
</td>
<td style="text-align:left;">
p__un_k__Bacteria
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Acidobacteria
</td>
<td style="text-align:left;">
p__Candidatus_Saccharibacteria
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Acidobacteria
</td>
<td style="text-align:left;">
p__Verrucomicrobia
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Actinobacteria
</td>
<td style="text-align:left;">
p__Armatimonadetes
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Actinobacteria
</td>
<td style="text-align:left;">
p__Ignavibacteriae
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Actinobacteria
</td>
<td style="text-align:left;">
p__Thaumarchaeota
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Actinobacteria
</td>
<td style="text-align:left;">
p__un_k__Bacteria
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Armatimonadetes
</td>
<td style="text-align:left;">
p__Bacteroidetes
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Armatimonadetes
</td>
<td style="text-align:left;">
p__Firmicutes
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Armatimonadetes
</td>
<td style="text-align:left;">
p__Planctomycetes
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Bacteroidetes
</td>
<td style="text-align:left;">
p__Planctomycetes
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Bacteroidetes
</td>
<td style="text-align:left;">
p__Thaumarchaeota
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Proteobacteria
</td>
<td style="text-align:left;">
p__Thaumarchaeota
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Spirochaetes
</td>
<td style="text-align:left;">
p__Verrucomicrobia
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
p__Thaumarchaeota
</td>
<td style="text-align:left;">
p__Verrucomicrobia
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
p__un_k__Bacteria
</td>
<td style="text-align:left;">
p__Verrucomicrobia
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table></div>
</div>
<p>Then you can use sankey plot to display the links.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pcutils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pcutils/man/my_sankey.html">my_sankey</a></span><span class="op">(</span><span class="va">Phylum_from_to</span>,dragY <span class="op">=</span><span class="cn">T</span>,fontSize <span class="op">=</span> <span class="fl">10</span>,width<span class="op">=</span><span class="fl">600</span>,numberFormat <span class="op">=</span> <span class="st">",.4"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:4-sankey"></span>
<div id="htmlwidget-62172a946530eb57cc9a" style="width:600px;height:480px;" class="sankeyNetwork html-widget "></div>
<script type="application/json" data-for="htmlwidget-62172a946530eb57cc9a">{"x":{"links":{"source":[0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,3,3,3,3,3,3,3,3,3,4,5,5,5,6,6,6,6,7,7,7,7,7,8,9,10,11,11,11,11,11,12,13,14],"target":[15,16,17,18,19,20,21,15,22,16,23,18,19,24,25,26,20,27,28,21,29,16,19,26,20,16,23,18,19,26,20,27,28,21,20,19,20,27,19,24,20,21,19,26,20,27,21,20,20,20,20,27,28,21,29,21,21,21],"value":[18,4,1,4,4,35,1,123,1,48,4,10,78,1,2,9,353,3,1,11,1,1,1,1,3,7,5,4,18,1,99,3,1,4,4,3,14,2,6,2,23,2,23,2,143,2,4,3,4,14,401,5,1,22,2,1,1,1]},"nodes":{"name":["p__Acidobacteria","p__Actinobacteria","p__Armatimonadetes","p__Bacteroidetes","p__Candidatus_Saccharibacteria","p__Chlamydiae","p__Chloroflexi","p__Firmicutes","p__Ignavibacteriae","p__Nitrospirae","p__Planctomycetes","p__Proteobacteria","p__Spirochaetes","p__Thaumarchaeota","p__un_k__Bacteria","p__Actinobacteria ","p__Bacteroidetes ","p__Candidatus_Saccharibacteria ","p__Chloroflexi ","p__Firmicutes ","p__Proteobacteria ","p__Verrucomicrobia ","p__Armatimonadetes ","p__Chlamydiae ","p__Ignavibacteriae ","p__Nitrospirae ","p__Planctomycetes ","p__Spirochaetes ","p__Thaumarchaeota ","p__un_k__Bacteria "],"group":["p__Acidobacteria","p__Actinobacteria","p__Armatimonadetes","p__Bacteroidetes","p__Candidatus_Saccharibacteria","p__Chlamydiae","p__Chloroflexi","p__Firmicutes","p__Ignavibacteriae","p__Nitrospirae","p__Planctomycetes","p__Proteobacteria","p__Spirochaetes","p__Thaumarchaeota","p__un_k__Bacteria","p__Actinobacteria ","p__Bacteroidetes ","p__Candidatus_Saccharibacteria ","p__Chloroflexi ","p__Firmicutes ","p__Proteobacteria ","p__Verrucomicrobia ","p__Armatimonadetes ","p__Chlamydiae ","p__Ignavibacteriae ","p__Nitrospirae ","p__Planctomycetes ","p__Spirochaetes ","p__Thaumarchaeota ","p__un_k__Bacteria "]},"options":{"NodeID":"name","NodeGroup":"name","LinkGroup":null,"colourScale":"d3.scaleOrdinal().range(d3.schemeCategory20)","fontSize":10,"fontFamily":null,"fontColor":null,"nodeWidth":10,"nodePadding":10,"nodeStrokeWidth":1,"nodeCornerRadius":0,"dragX":false,"dragY":true,"numberFormat":",.4","orderByPath":false,"units":"TWh","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"zoom":false,"linkType":"bezier","curvature":0.5,"highlightChildLinks":false,"doubleclickTogglesChildren":false,"showNodeValues":true,"align":"justify","xAxisDomain":["Phylum_from","Phylum_to"],"title":null,"nodeLabelMargin":2,"linkColor":"#A0A0A0","linkOpacity":0.5,"linkGradient":false,"nodeShadow":false,"scaleNodeBreadthsByString":false,"xScalingFactor":1,"yOrderComparator":null}},"evals":[],"jsHooks":[]}</script><p class="caption">
Figure 3.2: Sankey plot display edges according to Phylum
</p>
</div>
<p>Or use the circlize plot to display. <code>link_stat()</code> have more arguments than <code><a href="https://rdrr.io/pkg/MetaNet/man/summ_2col.html">summ_2col()</a></code> for summary edges.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/anno_vertex.html">anno_vertex</a></span><span class="op">(</span><span class="va">co_net</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">taxonomy</span>,<span class="st">"Phylum"</span><span class="op">)</span><span class="op">)</span><span class="op">-&gt;</span><span class="va">co_net1</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/links_stat.html">links_stat</a></span><span class="op">(</span><span class="va">co_net1</span>,topN <span class="op">=</span> <span class="fl">5</span>,group <span class="op">=</span> <span class="st">"Phylum"</span>,inter <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:4-circlize"></span>
<img src="03-manipulation_files/figure-html/4-circlize-1.png" alt="Circlize plot display edges according to Phylum" width="100%"><p class="caption">
Figure 3.3: Circlize plot display edges according to Phylum
</p>
</div>
<p>Other important action for a network is extracting the skeleton according to one group, which I call get skeleton plot.
<code><a href="https://rdrr.io/pkg/MetaNet/man/get_group_skeleton.html">get_group_skeleton()</a></code> can annotate all nodes with a group then combine each group nodes as a big node,
and calculate new links between all groups. This plot shows the flows between different groups clearly.
By the way, the result will display by different edge types, if you just want summary all edges, set the e_type as one same character (use <code><a href="https://rdrr.io/pkg/MetaNet/man/c_net_set.html">c_net_set()</a></code> as <a href="visualization.html#set-attri">4.1.1</a>).</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/get_group_skeleton.html">get_group_skeleton</a></span><span class="op">(</span><span class="va">co_net1</span>,Group <span class="op">=</span> <span class="st">"Phylum"</span><span class="op">)</span><span class="op">-&gt;</span><span class="va">ske_net</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">ske_net</span>,vertex.label<span class="op">=</span><span class="cn">NA</span>,legend_position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>left_leg_x<span class="op">=</span><span class="op">-</span><span class="fl">2.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:4-skeleton-1"></span>
<img src="03-manipulation_files/figure-html/4-skeleton-1.png" alt="Skeleton plot according to the Phylum." width="100%"><p class="caption">
Figure 3.4: Skeleton plot according to the Phylum.
</p>
</div>
<div class="figure">
<span style="display:block;" id="fig:4-skeleton-2"></span>
<img src="03-manipulation_files/figure-html/4-skeleton-2.png" alt="Skeleton plot according to the Phylum." width="100%"><p class="caption">
Figure 3.5: Skeleton plot according to the Phylum.
</p>
</div>
</div>
<div id="export" class="section level2" number="3.5">
<h2>
<span class="header-section-number">3.5</span> Export<a class="anchor" aria-label="anchor" href="#export"><i class="fas fa-link"></i></a>
</h2>
<p>MetaNet also support to export various format network files (dataframe, graphml,…) for following analysis in other softwares (Cytoscape, Gephi…).</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/c_net_save.html">c_net_save</a></span><span class="op">(</span><span class="va">co_net</span>,filename <span class="op">=</span> <span class="st">"My_net"</span>,format <span class="op">=</span> <span class="st">"data.frame"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/MetaNet/man/c_net_save.html">c_net_save</a></span><span class="op">(</span><span class="va">co_net</span>,filename <span class="op">=</span> <span class="st">"My_net"</span>,format <span class="op">=</span> <span class="st">"graphml"</span><span class="op">)</span></span></code></pre></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="construction.html"><span class="header-section-number">2</span> Construction</a></div>
<div class="next"><a href="visualization.html"><span class="header-section-number">4</span> Visualization</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#manipulation"><span class="header-section-number">3</span> Manipulation</a></li>
<li><a class="nav-link" href="#attributes"><span class="header-section-number">3.1</span> Attributes</a></li>
<li><a class="nav-link" href="#annotation"><span class="header-section-number">3.2</span> Annotation</a></li>
<li><a class="nav-link" href="#filter-sub-net"><span class="header-section-number">3.3</span> Filter (Sub-net)</a></li>
<li><a class="nav-link" href="#skeleton"><span class="header-section-number">3.4</span> Skeleton</a></li>
<li><a class="nav-link" href="#export"><span class="header-section-number">3.5</span> Export</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/Asa12138/MetaNet_tutorial/blob/master/03-manipulation.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/Asa12138/MetaNet_tutorial/edit/master/03-manipulation.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>MetaNet Tutorial</strong>" was written by Peng Chen. It was last built on 2023-06-25.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
